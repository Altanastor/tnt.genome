!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){"undefined"==typeof tnt&&(e.exports=tnt={}),tnt.board=t("./index.js"),tnt.utils=t("tnt.utils")},{"./index.js":2,"tnt.utils":39}],2:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":46}],3:[function(t,e,n){function r(){}var o=e.exports={};o.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e,n){e.exports=t("./src/api.js")},{"./src/api.js":5}],5:[function(t,e,n){var r=function(t){var e=function(){var t=[];return t.add_batch=function(e){t.unshift(e)},t.update=function(e,n){for(var r=0;r<t.length;r++)for(var o in t[r])if(o===e)return t[r][o]=n,!0;return!1},t.add=function(e,n){if(t.update(e,n));else{var r={};r[e]=n,t.add_batch(r)}},t.get=function(e){for(var n=0;n<t.length;n++)for(var r in t[n])if(r===e)return t[n][r]},t},n=e(),r=function(){};r.check=function(e,n,o){if(!(e instanceof Array))return"function"==typeof e?e.check(n,o):t[e].check(n,o),r;for(var a=0;a<e.length;a++)r.check(e[a],n,o)},r.transform=function(e,n){if(!(e instanceof Array))return"function"==typeof e?e.transform(n):t[e].transform(n),r;for(var o=0;o<e.length;o++)r.transform(e[o],n)};var o=function(e,r){var o=[],a=[],i=r.on_getter||function(){return n.get(e)},s=r.on_setter||function(t){for(var r=0;r<a.length;r++)t=a[r](t);for(var i=0;i<o.length;i++)if(!o[i].check(t)){var s=o[i].msg||"Value "+t+" doesn't seem to be valid for this method";throw s}n.add(e,t)},u=function(e){return arguments.length?(s(e),t):i()};u.check=function(t,e){return arguments.length?(o.push({check:t,msg:e}),this):o},u.transform=function(t){return arguments.length?(a.push(t),this):a},t[e]=u},a=function(t,e){if("object"==typeof t){n.add_batch(t);for(var r in t)o(r,e)}else n.add(t,e.default_value),o(t,e)};return r.getset=function(t,e){return a(t,{default_value:e}),r},r.get=function(t,e){var n=function(){throw"Method defined only as a getter (you are trying to use it as a setter"};return a(t,{default_value:e,on_setter:n}),r},r.set=function(t,e){var n=function(){throw"Method defined only as a setter (you are trying to use it as a getter"};return a(t,{default_value:e,on_getter:n}),r},r.method=function(e,n){if("object"==typeof e)for(var o in e)t[o]=e[o];else t[e]=n;return r},r};e.exports=n=r},{}],6:[function(t,e,n){e.exports=t("./src/index")},{"./src/index":16}],7:[function(t,e,n){e.exports=t(4)},{"./src/api.js":8}],8:[function(t,e,n){e.exports=t(5)},{}],9:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":10}],10:[function(t,e,n){var r=t("./utils.js");r.reduce=t("./reduce.js"),e.exports=n=r},{"./reduce.js":11,"./utils.js":12}],11:[function(t,e,n){var r=function(){var t=5,e="val",n=function(t,e){return e>t?.2*e>=e-t:.2*t>=t-e},r=function(t){return t},o=function(t){if(!t.length)return t;var e=s(t),n=r(e);return n},a=function(t,n){if(n.sort(function(t,n){return t[e]-n[e]}),n.length%2)t[e]=n[~~(n.length/2)][e];else{var r=~~(n.length/2)-1;t[e]=(n[r][e]+n[r+1][e])/2}return t},i=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},s=function(e){if(0===t)return e;for(var n=[],r=0;r<e.length;r++){var o=t>r?0:r-t,s=r>e.length-t?e.length:r+t;n[r]=a(i(e[r]),e.slice(o,s+1))}return n};return o.reducer=function(t){return arguments.length?(r=t,o):r},o.redundant=function(t){return arguments.length?(n=t,o):n},o.value=function(t){return arguments.length?(e=t,o):e},o.smooth=function(e){return arguments.length?(t=e,o):t},o},o=function(){var t=r().value("start"),e="end",n=function(n,r){return{object:{start:n.object[t.value()],end:r[e]},value:r[e]}};return t.reducer(function(r){for(var o=t.value(),a=t.redundant(),i=[],s={object:r[0],value:r[0][e]},u=1;u<r.length;u++)a(r[u][o],s.value)?s=n(s,r[u]):(i.push(s.object),s.object=r[u],s.value=r[u].end);return i.push(s.object),i}),r.join=function(e){return arguments.length?(n=e,t):n},r.value2=function(n){return arguments.length?(e=n,t):e},t},a=function(){var t=r();return t.reducer(function(e){for(var n=t.redundant(),r=t.value(),o=[],a=e[0],i=1;i<e.length-1;i++)n(e[i][r],a[r])||(o.push(a),a=e[i]);return o.push(a),o.push(e[e.length-1]),o}),t};e.exports=r,e.exports.line=a,e.exports.block=o},{}],12:[function(t,e,n){e.exports={iterator:function(t){var e=t||0,n=function(){return e++};return n},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(e+"$"),r=new RegExp("(.*)"+e+"$"),o=document.getElementsByTagName("script"),a="";if(void 0!==o)for(var i in o)if(o[i].src&&o[i].src.match(n))return o[i].src.replace(r,"$1");return a},defer_cancel:function(t,e){var n,r=function(){var r=Array.prototype.slice.call(arguments),o=this;clearTimeout(n),n=setTimeout(function(){t.apply(o,r)},e)};return r}}},{}],13:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").defer_cancel,a=function(){"use strict";function t(t){t.parentNode.appendChild(t)}var e,n,a,i,s,u=[],c=50,l=0,f=920,d=20,p={species:void 0,chr:void 0,from:0,to:500},h={left:void 0,right:void 0},g=3,v=d3.rgb("#F8FBEF"),m=d3.behavior.zoom(),y={min:0,max:1e3,zoom_out:1e3,zoom_in:100},_=500,x=!0,b={ease:d3.ease("cubic-in-out"),extend_canvas:{left:0,right:0},show_frame:!0},w=function(t){n=d3.select(t).attr("id"),d3.select(t).classed("tnt",!0);var r=d3.select(t).append("div").attr("id","tnt_"+n).style("position","relative").classed("tnt_framed",b.show_frame?!0:!1).style("width",f+2*g+b.extend_canvas.right+b.extend_canvas.left+"px"),o=r.append("div").attr("class","tnt_groupDiv");e=o.append("svg").attr("class","tnt_svg").attr("width",f).attr("height",l).attr("pointer-events","all"),i=e.append("g").attr("transform","translate(0,20)").append("g").attr("class","tnt_g"),h.left=i.append("rect").attr("id","tnt_"+n+"_5pcap").attr("x",0).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),h.right=i.append("rect").attr("id","tnt_"+n+"_3pcap").attr("x",f-g).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),a=i.append("rect").attr("class","tnt_pane").attr("id","tnt_"+n+"_pane").attr("width",f).attr("height",l).style("fill",v)},k=r(w).getset(b).getset(y).getset(p);k.transform(w.extend_canvas,function(t){var e=w.extend_canvas();return t.left=t.left||e.left,t.right=t.right||e.right,t}),k.method("start",function(){y.max-y.min<y.zoom_out&&(y.zoom_out=y.max-y.min),A();for(var t=0;t<u.length;t++)u[t].g&&u[t].g.remove(),q(u[t]);E();var e=function(){p.to-p.from<y.zoom_in&&(p.from+y.zoom_in>y.max?p.to=y.max:p.to=p.from+y.zoom_in);for(var t=0;t<u.length;t++)j(u[t],p)};e()}),k.method("update",function(){for(var t=0;t<u.length;t++)j(u[t])});var j=function(t,e){if(t.data()){var n=t.data(),r=n;r.call(t,{loc:e,on_success:function(){t.display().update.call(t,e)}})}},A=function(){s=d3.scale.linear().domain([p.from,p.to]).range([0,f]),x&&i.call(m.x(s).scaleExtent([(p.to-p.from)/(y.zoom_out-1),(p.to-p.from)/y.zoom_in]).on("zoom",O))},T=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=!1,o=0;o<u.length;o++)if(u[o].id()===t[n].id()){r=!0,e[o]=!0;break}r||(q(t[n]),j(t[n],{from:p.from,to:p.to}))}for(var a=0;a<u.length;a++)e[a]||u[a].g.remove();u=t,E()};k.method("scroll",function(t){var e=Math.abs(t);t>0?R(e,1):0>t&&R(e,-1)}),k.method("zoom",function(t){R(1/t,0)}),k.method("find_track",function(t){for(var e=0;e<u.length;e++)if(u[e].id()===t)return u[e]}),k.method("remove_track",function(t){t.g.remove()}),k.method("add_track",function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)w.add_track(t[e]);return w}return u.push(t),w}),k.method("tracks",function(t){return arguments.length?(T(t),this):u}),k.method("width",function(t){if(!arguments.length)return f;if(c>t&&(t=c),void 0!==n){d3.select("#tnt_"+n).select("svg").attr("width",t),d3.select("#tnt_"+n).style("width",parseInt(t)+2*g+"px"),d3.select("#tnt_"+n+"_pane").attr("width",t),h.right.attr("x",t-g),f=t,s.range([0,f]),A();for(var e=0;e<u.length;e++)u[e].g.select("rect").attr("width",t),u[e].display().scale(s),u[e].display().reset.call(u[e]),u[e].display().init.call(u[e],t),u[e].display().update.call(u[e],p)}else f=t;return w}),k.method("allow_drag",function(t){return arguments.length?(x=t,x?void 0!==s&&i.call(m.x(s).scaleExtent([(p.to-p.from)/(y.zoom_out-1),(p.to-p.from)/y.zoom_in]).on("zoom",O)):m.x(d3.scale.linear()).on("zoom",null),w):x});var E=function(){for(var r=0,o=0;o<u.length;o++){var i=u[o];i.g.attr("transform")?i.g.transition().duration(_).attr("transform","translate("+b.extend_canvas.left+","+r+")"):i.g.attr("transform","translate("+b.extend_canvas.left+","+r+")"),r+=i.height()}return e.attr("height",r+d),d3.select("#tnt_"+n).style("height",r+10+d+"px"),d3.select("#tnt_"+n+"_5pcap").attr("height",r).each(function(e){t(this)}),d3.select("#tnt_"+n+"_3pcap").attr("height",r).each(function(e){t(this)}),a.attr("height",r+d),w},q=function(t){return t.g=e.select("g").select("g").append("g").attr("class","tnt_track").attr("height",t.height()),t.g.append("rect").attr("x",0).attr("y",0).attr("width",w.width()).attr("height",t.height()).style("fill",t.color()).style("pointer-events","none"),t.display()&&t.display().scale(s).init.call(t,f),w},R=function(t,e){var n,r=s.domain(),o=r[1]-r[0],a=o*t-o;switch(e){case 1:n=[~~r[0]-a,~~(r[1]-a)];break;case-1:n=[~~r[0]+a,~~(r[1]-a)];break;case 0:n=[r[0]-~~(a/2),r[1]+~~a/2]}var i=d3.interpolateNumber(r[0],n[0]),u=b.ease,c=0;d3.timer(function(){var t,n=i(u(c));switch(e){case-1:t=n+o;break;case 1:t=n+o;break;case 0:t=r[1]+r[0]-n}var a=[n,t];return s.domain(a),O(s),c+=.02,c>1})},P=function(){var t=s.domain();w.from(~~t[0]),w.to(~~t[1]);for(var e=0;e<u.length;e++){var n=u[e];j(n,p)}},C=o(P,300),O=function(t){void 0!==t&&x&&m.x(t);var e=s.domain();e[0]<=y.min+5&&d3.select("#tnt_"+n+"_5pcap").attr("width",g).transition().duration(200).attr("width",0),e[1]>=y.max-5&&d3.select("#tnt_"+n+"_3pcap").attr("width",g).transition().duration(200).attr("width",0),e[0]<y.min?m.translate([m.translate()[0]-s(y.min)+s.range()[0],m.translate()[1]]):e[1]>y.max&&m.translate([m.translate()[0]-s(y.max)+s.range()[1],m.translate()[1]]),C();for(var r=0;r<u.length;r++){var o=u[r];o.display().move.call(o)}};return w};e.exports=n=a},{"tnt.api":7,"tnt.utils":9}],14:[function(t,e,n){var r=t("tnt.api"),o=t("./spinner.js")();tnt_data={},tnt_data.sync=function(){var t=function(e){var n=this;n.data().elements(t.retriever().call(n,e.loc)),e.on_success()};return r(t).getset("elements",[]).getset("retriever",function(){}),t},tnt_data.async=function(){var t=function(e){var n=this;o.on.call(n),t.retriever().call(n,e.loc).then(function(t){n.data().elements(t),e.on_success(),o.off.call(n)})};r(t).getset("elements",[]).getset("retriever");return t},tnt_data.empty=function(){var t=tnt_data.sync();return t},e.exports=n=tnt_data},{"./spinner.js":18,"tnt.api":7}],15:[function(t,e,n){var r=t("tnt.api"),o=t("./layout.js"),a=function(){var t=d3.dispatch("click","dblclick","mouseover","mouseout"),e={create:function(){throw"create_elem is not defined in the base feature object"},mover:function(){throw"move_elem is not defined in the base feature object"},updater:function(){},guider:function(){},index:void 0,layout:o.identity(),color:"#000",scale:void 0},n={},a=function(){var t=this;t.g.selectAll(".tnt_elem").remove(),t.g.selectAll(".tnt_guider").remove()},i=function(t){var n=this;n.g.append("text").attr("x",5).attr("y",12).attr("font-size",11).attr("fill","grey").text(n.label()),e.guider.call(n,t)},s=function(n,r,o){n.on("click",function(e,n){d3.event.defaultPrevented||t.click.call(this,e,n)}),n.on("mouseover",function(e,n){d3.event.defaultPrevented||t.mouseover.call(this,e,n)}),n.on("dblclick",function(e,n){d3.event.defaultPrevented||t.dblclick.call(this,e,n)}),n.on("mouseout",function(e,n){d3.event.defaultPrevented||t.mouseout.call(this,e,n)}),e.create.call(r,n,o)},u=function(t,r){var o=this,a=o.g,i=o.data().elements();void 0!==r&&(i=i[r]);var s=e.layout.call(o,i);if(void 0!==s){var u,c;u=void 0!==r?a.selectAll(".tnt_elem_"+r):a.selectAll(".tnt_elem"),c=e.index?u.data(s,function(t){return void 0!==t?e.index(t):void 0}):u.data(s),e.updater.call(o,c,e.scale);var l=c.enter();l.append("g").attr("class","tnt_elem").classed("tnt_elem_"+r,r).call(n.plot,o,e.scale),c.exit().remove()}},c=function(t){var n,r=this,o=r.g;n=void 0!==t?o.selectAll(".tnt_elem_"+t):o.selectAll(".tnt_elem"),e.mover.call(this,n)},l=function(t){t.parentNode.appendChild(t)},f=function(t){if(void 0!==t){var e=this,n=e.g;n.selectAll(".tnt_elem_"+t).each(function(){l(this)})}};return r(n).getset(e).method({reset:a,plot:s,update:u,move:c,init:i,move_to_front:f}),d3.rebind(n,t,"on")};a.composite=function(){var t={},e=[],n={},o=function(){for(var e=this,n=0;n<t.length;n++)t[n].reset.call(e)},a=function(e){var r=this;for(var o in t)t.hasOwnProperty(o)&&(t[o].scale(n.scale()),t[o].init.call(r,e))},i=function(){for(var n=this,r=0;r<e.length;r++)t[e[r]].update.call(n,void 0,e[r]),t[e[r]].move_to_front.call(n,e[r])},s=function(){var e=this;for(var n in t)t.hasOwnProperty(n)&&t[n].move.call(e,n)},u=function(r,o){return t[r]=o,e.push(r),n},c=function(){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n};return r(n).getset("scale").method({reset:o,update:i,move:s,init:a,add:u,displays:c}),n},a.area=function(){var t,e=a.line(),n=e.line(),r=d3.svg.area().interpolate(n.interpolate()).tension(e.tension()),o=e.create();e.create(function(a){var i=this,s=e.scale();void 0!==t&&i.g.select("path").remove(),o.call(i,a,s),r.x(n.x()).y1(n.y()).y0(i.height()),t=a.data(),a.remove(),i.g.append("path").attr("class","tnt_area").classed("tnt_elem",!0).datum(t).attr("d",r).attr("fill",d3.rgb(e.color()).brighter())});var i=e.mover();return e.mover(function(o){var a=this,s=e.scale();i.call(a,o,s),r.x(n.x()),a.g.select(".tnt_area").datum(t).attr("d",r)}),e},a.line=function(){var t=a(),e=function(t){return t.pos},n=function(t){return t.val},r=.7,o=d3.scale.linear(),i=d3.svg.line().interpolate("basis");t.line=function(){return i},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(e){return arguments.length?(n=e,t):n},t.tension=function(e){return arguments.length?(r=e,t):r};var s;return t.create(function(a){var u=this,c=t.scale();void 0!==s&&u.g.select("path").remove(),i.tension(r).x(function(t){return c(e(t))}).y(function(t){return u.height()-o(n(t))}),s=a.data(),a.remove(),o.domain([0,1]).range([0,u.height()-2]),u.g.append("path").attr("class","tnt_elem").attr("d",i(s)).style("stroke",t.color()).style("stroke-width",4).style("fill","none")}),t.mover(function(n){var r=this,o=t.scale();i.x(function(t){return o(e(t))}),r.g.select("path").attr("d",i(s))}),t},a.conservation=function(){var t=a.area(),e=t.create();return t.create(function(n){var r=this,o=t.scale();e.call(r,d3.select(n[0][0]),o)}),t},a.ensembl=function(){var t=a(),e="#7FFF00",n="#00BB00";return t.guider(function(e){var n=this,r=~~(n.height()-.8*n.height())/2;n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",r).attr("y2",r).style("stroke",t.color()).style("stroke-width",1),n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",n.height()-r).attr("y2",n.height()-r).style("stroke",t.color()).style("stroke-width",1)}),t.create(function(e){var n=this,r=t.scale(),o=~~(n.height()-.8*n.height())/2;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",o).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",n.height()-~~(2*o)).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return"high"===e.type?d3.rgb(t.color()):"low"===e.type?d3.rgb(t.color2()):d3.rgb(t.color3())})}),t.updater(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.mover(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t.color2=function(n){return arguments.length?(e=n,t):e},t.color3=function(e){return arguments.length?(n=e,t):n},t},a.vline=function(){var t=a();return t.create(function(e){var n=t.scale(),r=this;e.append("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))}).attr("y1",0).attr("y2",r.height()).attr("stroke",t.color()).attr("stroke-width",1)}),t.mover(function(e){var n=t.scale();e.select("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))})}),t},a.pin=function(){var t=a(),e=d3.scale.linear().domain([0,0]).range([0,0]),n={pos:d3.functor("pos"),val:d3.functor("val"),domain:[0,0]},o=5;return r(t).getset(n),t.create(function(r){var a=this,i=t.scale();e.domain(t.domain()).range([o,a.height()-o-10]),r.append("line").attr("x1",function(t,e){return i(t[n.pos(t,e)])}).attr("y1",function(t){return a.height()}).attr("x2",function(t,e){return i(t[n.pos(t,e)])}).attr("y2",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("stroke",function(e){return d3.functor(t.color())(e)}),r.append("circle").attr("cx",function(t,e){return i(t[n.pos(t,e)])}).attr("cy",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("r",o).attr("fill",function(e){return d3.functor(t.color())(e)}),r.append("text").attr("font-size","13").attr("x",function(t,e){return i(t[n.pos(t,e)])}).attr("y",function(t,e){return 10}).style("text-anchor","middle").text(function(t){return t.label||""})}),t.updater(function(t){t.select("text").text(function(t){return t.label||""})}),t.mover(function(r){var o=this,a=t.scale();r.select("line").attr("x1",function(t,e){return a(t[n.pos(t,e)])}).attr("y1",function(t){return o.height()}).attr("x2",function(t,e){return a(t[n.pos(t,e)])}).attr("y2",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("circle").attr("cx",function(t,e){return a(t[n.pos(t,e)])}).attr("cy",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("text").attr("x",function(t,e){return a(t[n.pos(t,e)])}).text(function(t){return t.label||""})}),t.guider(function(t){var e=this;e.g.append("line").attr("x1",0).attr("x2",t).attr("y1",e.height()).attr("y2",e.height()).style("stroke","black").style("stroke-with","1px")}),t},a.block=function(){var t=a();return r(t).getset("from",function(t){return t.start}).getset("to",function(t){return t.end}),t.create(function(e){var n=this,r=t.scale();e.append("rect").attr("x",function(e,n){return r(t.from()(e,n))}).attr("y",0).attr("width",function(e,n){return r(t.to()(e,n))-r(t.from()(e,n))}).attr("height",n.height()).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color})}),t.updater(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.mover(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t},a.axis=function(){var t,e,n="top",r={};return r.reset=function(){t=void 0;var e=this;e.g.selectAll("rect").remove(),e.g.selectAll(".tick").remove()},r.plot=function(){},r.move=function(){var e=this,n=e.g;n.call(t)},r.init=function(){t=void 0},r.update=function(){void 0===t&&(t=d3.svg.axis().scale(e).orient(n));var r=this,o=r.g;o.call(t)},r.orientation=function(t){return arguments.length?(n=t,this):n},r.scale=function(t){return arguments.length?(e=t,this):e},r},a.location=function(){var t,e,n={};return n.reset=function(){t=void 0},n.plot=function(){},n.init=function(){t=void 0},n.move=function(){var n=e.domain();t.select("text").text("Location: "+~~n[0]+"-"+~~n[1])},n.scale=function(t){return arguments.length?(e=t,this):e},n.update=function(n){var r=this,o=r.g,a=e.domain();void 0===t&&(t=o,t.append("text").text("Location: "+Math.round(a[0])+"-"+Math.round(a[1])))},n},e.exports=n=a},{"./layout.js":17,"tnt.api":7}],16:[function(t,e,n){var r=t("./board.js");r.track=t("./track"),r.track.data=t("./data.js"),r.track.layout=t("./layout.js"),r.track.feature=t("./feature.js"),r.track.layout=t("./layout.js"),e.exports=n=r},{"./board.js":13,"./data.js":14,"./feature.js":15,"./layout.js":17,"./track":19}],17:[function(t,e,n){var r=t("tnt.api"),o=function(){var t=function(e){var n=this;return t.elements().call(n,e),e};r(t).getset("elements",function(){});return t};o.identity=function(){return o().elements(function(t){return t})},e.exports=n=o},{"tnt.api":7}],18:[function(t,e,n){var r=function(){function t(t,e,n){t.append("rect").attr("x","46.5").attr("y","40").attr("width","7").attr("height","20").attr("rx","5").attr("ry","5").attr("fill",d3.rgb(n).darker(2)).attr("transform","rotate("+30*e+" 50 50) translate(0 -30)").append("animate").attr("attributeName","opacity").attr("from","1").attr("to","0").attr("dur","1s").attr("begin",1/12*e+"s").attr("repeatCount","indefinite")}var e,n={};return n.on=function(){var n=this;if(n.spinner?n.spinner++:n.spinner=1,1==n.spinner){var r=n.g,o=n.color();e=r.append("svg").attr("class","tnt_spinner").attr("width","30px").attr("height","30px").attr("xmls","http://www.w3.org/2000/svg").attr("viewBox","0 0 100 100").attr("preserveAspectRatio","xMidYMid"),e.append("rect").attr("x","0").attr("y","0").attr("width","100").attr("height","100").attr("rx","50").attr("ry","50").attr("fill",o);for(var a=0;12>a;a++)t(e,a,o)}else if(n.spinner>0){var i=e.node();i.parentNode&&i.parentNode.appendChild(i)}},n.off=function(){var t=this;if(t.spinner--,!t.spinner){var e=t.g;e.selectAll(".tnt_spinner").remove()}},n};e.exports=n=r},{}],19:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").iterator,a=function(){"use strict";var t,e={color:d3.rgb("#CCCCCC"),height:250,data:a.data.empty(),label:"",id:a.id()},n={};r(n).getset(e);return n.display=function(n){if(!arguments.length)return t;if(t=n,"function"==typeof t)t.layout&&t.layout().height(e.height);else for(var r in t)t.hasOwnProperty(r)&&t[r].layout&&t[r].layout().height(e.height);return this},n};a.id=o(1),e.exports=n=a},{"tnt.api":7,"tnt.utils":9}],20:[function(t,e,n){e.exports=tnt_rest=t("./src/rest.js")},{"./src/rest.js":37}],21:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){Y=t}function u(t){K=t}function c(){return function(){n.nextTick(h)}}function l(){return function(){X(h)}}function f(){var t=0,e=new Q(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function d(){var t=new MessageChannel;return t.port1.onmessage=h,function(){t.port2.postMessage(0)}}function p(){return function(){setTimeout(h,1)}}function h(){for(var t=0;G>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}G=0}function g(){try{var e=t,n=e("vertx");return X=n.runOnLoop||n.runOnContext,l()}catch(r){return p()}}function v(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return at.error=e,at}}function x(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function b(t,e,n){K(function(t){var r=!1,o=x(n,e,function(n){r||(r=!0,e!==n?j(t,n):T(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function w(t,e){e._state===rt?T(t,e._result):e._state===ot?E(t,e._result):q(e,void 0,function(e){j(t,e)},function(e){E(t,e)})}function k(t,e){if(e.constructor===t.constructor)w(t,e);else{var n=_(e);n===at?E(t,at.error):void 0===n?T(t,e):a(n)?b(t,e,n):T(t,e)}}function j(t,e){t===e?E(t,m()):o(e)?k(t,e):T(t,e)}function A(t){t._onerror&&t._onerror(t._result),R(t)}function T(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&K(R,t))}function E(t,e){t._state===nt&&(t._state=ot,t._result=e,K(A,t))}function q(t,e,n,r){var o=t._subscribers,a=o.length;t._onerror=null,o[a]=e,o[a+rt]=n,o[a+ot]=r,0===a&&t._state&&K(R,t)}function R(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,a=t._result,i=0;i<e.length;i+=3)r=e[i],o=e[i+n],r?O(n,r,o,a):o(a);t._subscribers.length=0}}function P(){this.error=null}function C(t,e){try{return t(e)}catch(n){return it.error=n,it}}function O(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=C(n,r),o===it?(u=!0,i=o.error,o=null):s=!0,e===o)return void E(e,y())}else o=r,s=!0;e._state!==nt||(c&&s?j(e,o):u?E(e,i):t===rt?T(e,o):t===ot&&E(e,o))}function z(t,e){try{e(function(e){j(t,e)},function(e){E(t,e)})}catch(n){E(t,n)}}function M(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(v),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?T(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&T(n.promise,n._result))):E(n.promise,n._validationError())}function S(t){return new st(this,t).promise}function N(t){function e(t){j(o,t)}function n(t){E(o,t)}var r=this,o=new r(v);if(!J(t))return E(o,new TypeError("You must pass an array to race.")),o;for(var a=t.length,i=0;o._state===nt&&a>i;i++)q(r.resolve(t[i]),void 0,e,n);return o}function H(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(v);return j(n,t),n}function L(t){var e=this,n=new e(v);return E(n,t),n}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(t){this._id=dt++,this._state=void 0,this._result=void 0,this._subscribers=[],v!==t&&(a(t)||$(),this instanceof F||I(),z(this,t))}function B(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=pt)}var U;U=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var X,Y,D,J=U,G=0,K=({}.toString,function(t,e){et[G]=t,et[G+1]=e,G+=2,2===G&&(Y?Y(h):D())}),V="undefined"!=typeof window?window:void 0,W=V||{},Q=W.MutationObserver||W.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);D=Z?c():Q?f():tt?d():void 0===V&&"function"==typeof t?g():p();var nt=void 0,rt=1,ot=2,at=new P,it=new P;M.prototype._validateInput=function(t){return J(t)},M.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},M.prototype._init=function(){this._result=new Array(this.length)};var st=M;M.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===nt&&e>o;o++)t._eachEntry(r[o],o)},M.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},M.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===nt&&(r._remaining--,t===ot?E(o,n):r._result[e]=n),0===r._remaining&&T(o,r._result)},M.prototype._willSettleAt=function(t,e){var n=this;q(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(ot,e,t)})};var ut=S,ct=N,lt=H,ft=L,dt=0,pt=F;F.all=ut,F.race=ct,F.resolve=lt,F.reject=ft,F._setScheduler=s,F._setAsap=u,F._asap=K,F.prototype={constructor:F,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===ot&&!e)return this;var o=new this.constructor(v),a=n._result;if(r){var i=arguments[r-1];K(function(){O(r,o,i,a)})}else q(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ht=B,gt={Promise:pt,polyfill:ht};"function"==typeof define&&define.amd?define(function(){return gt}):"undefined"!=typeof e&&e.exports?e.exports=gt:"undefined"!=typeof this&&(this.ES6Promise=gt),ht()}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:3}],22:[function(t,e,n){"use strict";!function(t,r){"function"==typeof define&&define.amd?define(function(){return t.httppleasepromises=r(t)}):"object"==typeof n?e.exports=r(t):t.httppleasepromises=r(t)}(this,function(t){return function(e){if(e=e||t&&t.Promise,!e)throw new Error("No Promise implementation found.");return{processRequest:function(t){var n,r,o=t.onload,a=t.onerror,i=new e(function(t,e){n=t,r=e});t.onload=function(t){var e;return o&&(e=o.apply(this,arguments)),n(t),e},t.onerror=function(t){var e;return a&&(e=a.apply(this,arguments)),r(t),e},t.then=function(){return i.then.apply(i,arguments)},t["catch"]=function(){return i["catch"].apply(i,arguments)}}}}})},{}],23:[function(t,e,n){"use strict";function r(t,e){var n=new Error(t);n.name="RequestError",this.name=n.name,this.message=n.message,n.stack&&(this.stack=n.stack),this.toString=function(){return this.message};for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r])}var o=t("./response");r.prototype=Error.prototype,r.create=function(t,e,n){var a=new r(t,n);return o.call(a,e),a},e.exports=r},{"./response":26}],24:[function(t,e,n){"use strict";function r(t,e){function n(n,r){var a,p,h,g,v;for(n=new l(f(t,n)),o=0;o<e.length;o++)p=e[o],p.processRequest&&p.processRequest(n);for(o=0;o<e.length;o++)if(p=e[o],p.createXHR){a=p.createXHR(n);break}a=a||new i,n.xhr=a,h=d(s(function(t){clearTimeout(v),a.onload=a.onerror=a.onreadystatechange=a.ontimeout=a.onprogress=null;var i=t&&t.isHttpError?t:new c(n);for(o=0;o<e.length;o++)p=e[o],p.processResponse&&p.processResponse(i);t?n.onerror&&n.onerror(t):n.onload&&n.onload(i),r&&r(t,i)})),a.onreadystatechange=function(){if(!n.timedOut)if(n.aborted)h(u("Request aborted",n,{name:"Abort"}));else if(4===a.readyState){var t=Math.floor(a.status/100);if(2===t)h();else if(404!==a.status||n.errorOn404){var e;switch(t){case 4:e="Client";break;case 5:e="Server";break;default:e="HTTP"}var r=e+" Error: The server returned a status of "+a.status+' for the request "'+n.method.toUpperCase()+" "+n.url+'"';h(u(r,n))}else h()}},a.onload=function(){h()},a.onerror=function(){h(u("Internal XHR Error",n))},a.ontimeout=function(){},a.onprogress=function(){},a.open(n.method,n.url),n.timeout&&(v=setTimeout(function(){n.timedOut=!0,h(u("Request timeout",n,{name:"Timeout"}));try{a.abort()}catch(t){}},n.timeout));for(g in n.headers)n.headers.hasOwnProperty(g)&&a.setRequestHeader(g,n.headers[g]);return a.send(n.body),n}t=t||{},e=e||[];var a,p=["get","post","put","head","patch","delete"],h=function(t){return function(e,r){return e=new l(e),e.method=t,n(e,r)}};for(o=0;o<p.length;o++)a=p[o],n[a]=h(a);return n.plugins=function(){return e},n.defaults=function(n){return n?r(f(t,n),e):t},n.use=function(){var n=Array.prototype.slice.call(arguments,0);return r(t,e.concat(n))},n.bare=function(){return r()},n.Request=l,n.Response=c,n}var o,a=t("../plugins/cleanurl"),i=t("./xhr"),s=t("./utils/delay"),u=t("./error").create,c=t("./response"),l=t("./request"),f=t("xtend"),d=t("./utils/once");
e.exports=r({},[a])},{"../plugins/cleanurl":31,"./error":23,"./request":25,"./response":26,"./utils/delay":27,"./utils/once":28,"./xhr":29,xtend:30}],25:[function(t,e,n){"use strict";function r(t){var e="string"==typeof t?{url:t}:t||{};this.method=e.method?e.method.toUpperCase():"GET",this.url=e.url,this.headers=e.headers||{},this.body=e.body,this.timeout=e.timeout||0,this.errorOn404=null!=e.errorOn404?e.errorOn404:!0,this.onload=e.onload,this.onerror=e.onerror}r.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this)},r.prototype.header=function(t,e){var n;for(n in this.headers)if(this.headers.hasOwnProperty(n)&&t.toLowerCase()===n.toLowerCase()){if(1===arguments.length)return this.headers[n];delete this.headers[n];break}return null!=e?(this.headers[t]=e,e):void 0},e.exports=r},{}],26:[function(t,e,n){"use strict";function r(t){var e,n,r,o=t.xhr;if(this.request=t,this.xhr=o,this.headers={},!t.aborted&&!t.timedOut){if(this.status=o.status||0,this.text=o.responseText,this.body=o.response||o.responseText,this.contentType=o.contentType||o.getResponseHeader&&o.getResponseHeader("Content-Type"),o.getAllResponseHeaders)for(n=o.getAllResponseHeaders().split("\n"),e=0;e<n.length;e++)(r=n[e].match(/\s*([^\s]+):\s+([^\s]+)/))&&(this.headers[r[1]]=r[2]);this.isHttpError=this.status>=400}}var o=t("./request");r.prototype.header=o.prototype.header,e.exports=r},{"./request":25}],27:[function(t,e,n){"use strict";e.exports=function(t){return function(){var e=Array.prototype.slice.call(arguments,0),n=function(){return t.apply(null,e)};setTimeout(n,0)}}},{}],28:[function(t,e,n){"use strict";e.exports=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments)),e}}},{}],29:[function(t,e,n){e.exports=window.XMLHttpRequest},{}],30:[function(t,e,n){function r(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}e.exports=r},{}],31:[function(t,e,n){"use strict";e.exports={processRequest:function(t){t.url=t.url.replace(/[^%]+/g,function(t){return encodeURI(t)})}}},{}],32:[function(t,e,n){"use strict";var r=t("./jsonrequest"),o=t("./jsonresponse");e.exports={processRequest:function(t){r.processRequest.call(this,t),o.processRequest.call(this,t)},processResponse:function(t){o.processResponse.call(this,t)}}},{"./jsonrequest":33,"./jsonresponse":34}],33:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Content-Type"),n=e&&-1!==e.indexOf("application/json");(null==e||n)&&t.body&&(e||t.header("Content-Type","application/json"),t.body=JSON.stringify(t.body))}}},{}],34:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Accept");null==e&&t.header("Accept","application/json")},processResponse:function(t){if(t.contentType&&/^.*\/(?:.*\+)?json(;|$)/i.test(t.contentType)){var e="string"==typeof t.body?t.body:t.text;e&&(t.body=JSON.parse(e))}}}},{}],35:[function(t,e,n){e.exports=t(4)},{"./src/api.js":36}],36:[function(t,e,n){e.exports=t(5)},{}],37:[function(t,e,n){var r=t("httpplease"),o=t("tnt.api"),a=t("httpplease-promises"),i=t("es6-promise").Promise,s=t("httpplease/plugins/json");r=r.use(s).use(a(i)),tnt_rest=function(){var e={prefix:"",protocol:"http",domain:"",port:""},n={};n.url=t("./url.js");var a=o(n).getset(e);return a.method("call",function(t,n){var o;return"string"==typeof t?o=t:(t._prefix(e.prefix)._protocol(e.protocol)._domain(e.domain)._port(e.port),o=t()),n?r.post({url:o,body:n}):r.get({url:o})}),n},e.exports=n=tnt_rest},{"./url.js":38,"es6-promise":21,httpplease:24,"httpplease-promises":22,"httpplease/plugins/json":32,"tnt.api":35}],38:[function(t,e,n){var r=t("tnt.api"),o=function(){function t(e){var n=a.parameters[e];if(!Array.isArray(n))return n;var r=n.shift();return n.length?r+"&"+e+"="+t(e):r}function e(){void 0===a.parameters["content-type"]&&(a.parameters["content-type"]="application/json");var e=Object.keys(a.parameters).map(function(e){return e+"="+t(e)}).join("&");return e?"?"+e:e}function n(){var t=a.endpoint,n=t.replace(o,function(t){t=t.substring(1,t.length);var e=a.parameters[t]||"";return delete a.parameters[t],e}),r=a._prefix+a._protocol+"://"+a._domain+(a._port?":"+port:"")+"/"+n+e()+(a.fragment?"#"+a.fragment:"");return r}var o=/:\w+/g,a={_prefix:"",_protocol:"http",_domain:"",_port:"",endpoint:"",parameters:{},fragment:"",rest:void 0},i=function(){return n()};r(i).getset(a);return i};e.exports=n=o},{"tnt.api":35}],39:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{"./src/index.js":40}],40:[function(t,e,n){arguments[4][10][0].apply(n,arguments)},{"./reduce.js":41,"./utils.js":42}],41:[function(t,e,n){e.exports=t(11)},{}],42:[function(t,e,n){e.exports={iterator:function(t){var e=t||0,n=function(){return e++};return n},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(e+"$"),r=new RegExp("(.*)"+e+"$"),o=document.getElementsByTagName("script"),a="";if(void 0!==o)for(var i in o)if(o[i].src&&o[i].src.match(n))return o[i].src.replace(r,"$1");return a},defer_cancel:function(t,e){var n,r=function(){var r=Array.prototype.slice.call(arguments),o=this;clearTimeout(n),n=setTimeout(function(){t.apply(o,r)},e)};return r}}},{}],43:[function(t,e,n){var r=t("tnt.board"),o=t("tnt.api"),a=function(){var t=r.track.data.genome.ensembl,e=r.track.data.async().retriever(function(e){var n=this,r=(n.display().scale(),t.url().endpoint("overlap/region/:species/:region").parameters({species:e.species,region:e.chr+":"+e.from+"-"+e.to,feature:e.features||["gene"]}));return t.call(r).then(function(t){for(var e=t.body,n=0;n<e.length;n++){var r=e[n];-1===r.strand?r.display_label="<"+r.external_name:r.display_label=r.external_name+">"}return e})});return o(e).getset("ensembl"),e},i=function(){function t(t){for(var e=t.exons,n=[],r=0;r<e.length-1;r++){var o={start:1===e[r].transcript.strand?e[r].end:e[r].start,end:1===e[r].transcript.strand?e[r+1].start:e[r+1].end,transcript:t};n.push(o)}return n}function e(t){var e,n;void 0!==t.Translation&&(e=t.Translation.start,n=t.Translation.end);var r=t.Exon,o=[];if(r)for(var a=0;a<r.length;a++)if(void 0===t.Translation)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else if(r[a].start<e)if(r[a].end<e)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var i={start:r[a].start,end:e,transcript:t,coding:!1,offset:r[a].start-t.start},s={start:e,end:r[a].end,transcript:t,coding:!0,offset:e-t.start};1===r[a].strand?(o.push(i),o.push(s)):(o.push(s),o.push(i))}else if(r[a].end>n)if(r[a].start>n)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var u={start:r[a].start,end:n,transcript:t,coding:!0,offset:r[a].start-t.start},c={start:n,end:r[a].end,transcript:t,coding:!1,offset:n-t.start};1===r[a].strand?(o.push(u),o.push(c)):(o.push(c),o.push(u))}else o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!0,offset:r[a].start-t.start});return o}var n=r.track.data.genome.ensembl,a=r.track.data.async().retriever(function(t){var e=n.url().endpoint("overlap/region/:species/:region").parameters({species:t.species,region:t.chr+":"+t.from+"-"+t.to,feature:["gene","transcript","exon","cds"]});return n.call(e).then(function(t){for(var e=t.body,n=a.region2genes(e),r=[],o=0;o<n.length;o++){var i=n[o],s=a.gene2Transcripts(i);r=r.concat(s)}return r})});return o(a).method("gene2Transcripts",function(n){for(var r=n.Transcript,o=[],a=0;a<r.length;a++){var i=r[a];i.exons=e(i),i.introns=t(i),i.display_label=1===i.strand?i.display_name+">":"<"+i.display_name,i.key=i.id+"_"+i.exons.length,i.gene=n,o.push(i)}return o}).method("region2genes",function(t){for(var e={},n=[],r={},o=0;o<t.length;o++){var a=t[o];"transcript"==a.feature_type&&(a.display_name=a.external_name,r[a.id]=a,void 0===e[a.Parent]&&(e[a.Parent]=[]),e[a.Parent].push(a))}for(var i=0;i<t.length;i++){var a=t[i];if("exon"===a.feature_type){var s=r[a.Parent];void 0===s.Exon&&(s.Exon=[]),s.Exon.push(a)}}for(var u=0;u<t.length;u++){var a=t[u];if("cds"===a.feature_type){var s=r[a.Parent];void 0===s.Translation&&(s.Translation=a),a.start<s.Translation.start&&(s.Translation.start=a.start),a.end>s.Translation.end&&(s.Translation.end=a.end)}}for(var c=0;c<t.length;c++){var a=t[c];"gene"===a.feature_type&&(a.display_name=a.external_name,a.Transcript=e[a.id],n.push(a))}return n}),a},s=function(){var t=r.track.data.genome.ensembl,e=r.track.data.async().retriever(function(n){if(n.to-n.from<e.limit()){var r=t.url().endpoint("/sequence/region/:species/:region").parameters({species:n.species,region:n.chr+":"+n.from+".."+n.to});return t.call(r).then(function(t){for(var e=t.body,n=e.id.split(":"),r=n[3],o=[],a=0;a<e.seq.length;a++)o.push({pos:+r+a,sequence:e.seq[a]});return o})}return new Promise(function(t,e){t([])})});return o(e).getset("limit",150),e},u={gene:a,sequence:s,transcript:i};e.exports=n=u},{"tnt.api":4,"tnt.board":6}],44:[function(t,e,n){var r=t("tnt.api"),o=(t("./layout.js"),t("tnt.board")),a=function(){var t=o.track.feature().layout(o.track.layout.genome()).index(function(t){return t.key});return t.create(function(e,n){var r=this,o=e.append("g").attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});o.append("line").attr("x1",0).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y2",~~(t.layout().gene_slot().gene_height/2)).attr("fill","none").attr("stroke",r.color()).attr("stroke-width",2).transition().duration(500).attr("stroke",function(e){return t.color()(e)}),e.each(function(t){if(t.exons)for(var e=0;e<t.exons.length;e++)t.exons[e].slot=t.slot});var a=o.selectAll(".exons").data(function(t){return t.exons||[]},function(t){return t.start});a.enter().append("rect").attr("class","tnt_exons").attr("x",function(t){return n(t.start+t.offset)-n(t.start)}).attr("y",0).attr("width",function(t){return n(t.end)-n(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",r.color()).attr("stroke",r.color()).transition().duration(500).attr("stroke",function(e){return t.color()(e)}).attr("fill",function(e){return e.coding?t.color()(e):e.coding===!1?r.color():t.color()(e)}),o.append("text").attr("class","tnt_name").attr("x",0).attr("y",25).attr("fill",r.color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(e){return t.color()(e)})}),t.updater(function(e,n){var r=e.select("g").transition().duration(200).attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("rect").attr("height",t.layout().gene_slot().gene_height),r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.select("text").text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.mover(function(e){var n=t.scale(),r=e.select("g").attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.selectAll("rect").attr("width",function(t){return n(t.end)-n(t.start)}),r.selectAll(".tnt_exons").attr("x",function(t){return n(t.start+t.offset)-n(t.start)})}),t},i=function(){var t={fontsize:10,sequence:function(t){return t.sequence}},e=o.track.feature().index(function(t){return t.pos});r(e).getset(t);return e.create(function(n,r){var o=this;n.append("text").attr("fill",o.color()).style("font-size",t.fontsize+"px").attr("x",function(e){return r(e.pos)-t.fontsize/2+1}).attr("y",function(t){return~~(o.height()/2)+5}).style("font-family",'"Lucida Console", Monaco, monospace').text(t.sequence).transition().duration(500).attr("fill",e.color())}),e.mover(function(n){var r=e.scale();n.select("text").attr("x",function(e){return r(e.pos)-t.fontsize/2+1})}),e},s=function(){var t=o.track.feature().layout(o.track.layout.genome()).index(function(t){return t.id});return t.create(function(e,n){var r=this;e.append("rect").attr("x",function(t){return n(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("width",function(t){return n(t.end)-n(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",r.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color}),e.append("text").attr("class","tnt_name").attr("x",function(t){return n(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).attr("fill",r.color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(){return t.color()})}),t.updater(function(e){e.select("rect").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("height",t.layout().gene_slot().gene_height),e.select("text").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.mover(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)}),e.select("text").attr("x",function(t){return n(t.start)})}),t},u=function(){var t,e,n,r,o=function(t,e,n,r){return t+" "+e+":"+n+"-"+r},a={};return a.reset=function(){},a.plot=function(){},a.init=function(){e=void 0},a.move=function(){var t=a.scale(),i=t.domain();e.select("text").text(o(r,n,~~i[0],~~i[1]))},a.update=function(a){n=a.chr,r=a.species;var i=this,s=i.g,u=t.domain();void 0===e&&(e=s,e.append("text").text(o(r,n,~~u[0],~~u[1])))},a.scale=function(e){return arguments.length?(t=e,this):t},a.text=function(t){return arguments.length?(o=t,this):o},a},c={gene:s,sequence:i,transcript:a,location:u};e.exports=n=c},{"./layout.js":47,"tnt.api":4,"tnt.board":6}],45:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.board");o.track.data.genome=t("./data.js"),o.track.feature.genome=t("./feature"),o.track.layout.genome=t("./layout"),o.track.data.genome.ensembl=t("tnt.rest")().domain("rest.ensembl.org"),tnt_board_genome=function(){"use strict";var t=o.track.data.genome.ensembl,e=/^ENS\w+\d+$/,n={gene:void 0,xref_search:function(){},ensgene_search:function(){},context:0,rest:t},a=o().zoom_in(200).zoom_out(5e6).min(0),i=o.track().height(20).color("white").data(o.track.data.empty()).display(o.track.feature.genome.location()),s=o.track().height(0).color("white").data(o.track.data.empty()).display(o.track.feature.axis());a.add_track(i).add_track(s),a.species("human").chr(7).from(139424940).to(141784100),a._start=a.start;var u=function(e){if(void 0!==e){if(void 0!==e.gene)return void f(e);void 0===e.species?e.species=a.species():a.species(e.species),void 0===e.chr?e.chr=a.chr():a.chr(e.chr),void 0===e.from?e.from=a.from():a.from(e.from),void 0===e.to?e.to=a.to():a.to(e.to)}else{if(void 0!==a.gene())return void f({species:a.species(),gene:a.gene()});e={},e.species=a.species(),e.chr=a.chr(),e.from=a.from(),e.to=a.to()}var n=t.url().endpoint("info/assembly/:species/:region_name").parameters({species:e.species,region_name:e.chr});t.call(n).then(function(t){a.max(t.body.length),a._start()})},c=function(e,n){var r=t.url.homologues({id:e});t.call(r).then(function(t){var e=t.body.data[0].homologies;if(void 0!==n){var r=p(e);n(r)}})},l=function(t){return t.match(e)?!0:!1},f=function(e){if(l(e.gene))d(e.gene);else{var r=t.url().endpoint("xrefs/symbol/:species/:symbol").parameters({species:e.species,symbol:e.gene});t.call(r).then(function(t){var r=t.body;r=r.filter(function(t){return!t.id.indexOf("ENS")}),void 0!==r[0]&&d(r[0].id),n.xref_search(t,e.gene,e.species)})}},d=function(e){var r=t.url().endpoint("/lookup/id/:id").parameters({id:e});t.call(r).then(function(t){var e=t.body;n.ensgene_search(e);var r=~~((e.end-e.start)*(n.context/100));a.species(e.species).chr(e.seq_region_name).from(e.start-r).to(e.end+r),a.start({species:e.species,chr:e.seq_region_name,from:e.start-r,to:e.end+r})})},p=function(t){var e=/ortholog/,n=/paralog/,r=t.filter(function(t){return t.type.match(e)}),o=t.filter(function(t){return t.type.match(n)});return{orthologues:r,paralogues:o}},h=r(a).getset(n);return h.method({start:u,homologues:c}),a},e.exports=n=tnt_board_genome},{"./data.js":43,"./feature":44,"./layout":47,"tnt.api":4,"tnt.board":6,"tnt.rest":20}],46:[function(t,e,n){var r=t("tnt.board");r.genome=t("./genome"),e.exports=n=r},{"./genome":45,"tnt.board":6}],47:[function(t,e,n){var r=t("tnt.api"),o=function(){var t,e,n=[],o={expanded:{slot_height:30,gene_height:10,show_label:!0},collapsed:{slot_height:10,gene_height:7,show_label:!1}},a="expanded",i=function(r){var s=this;e=s.display().scale();for(var c=0;c<r.length;c++)null===r[c].external_name&&(r[c].external_name="");t=~~(s.height()/o.expanded.slot_height),i.keep_slots()&&l(r,n);var f=u(r);return o.collapsed.needed_slots=f,o.expanded.needed_slots=f,a=i.fixed_slot_type()?i.fixed_slot_type():f>t?"collapsed":"expanded",i.on_layout_run()(o,a),n=r,r},s=function(){return o[a]},u=function(e){for(var n=[],r=e,o=0,a=0;a<e.length;a++)e[a].slot>o&&e[a].slot<t&&(o=e[a].slot);for(var i=0;i<r.length;i++){var s=d(n),u=r[i];if(void 0!==u.slot&&u.slot<t&&c(u,s[u.slot]))n.push(u);else for(var l=0;;){if(c(u,s[l])){u.slot=l,n.push(u),l>o&&(o=l);break}l++}}return o+1},c=function(t,n){if(void 0===n)return!0;for(var r=0;r<n.length;r++){var o=n[r];if(t.id!==o.id){var a=8*o.display_label.length+e(o.start),i=e(o.start),s=e(o.end)>a?e(o.end):a,u=8*t.display_label.length+e(t.start),c=e(t.start),l=e(t.end)>u?e(t.end):u;if(i>=c&&l>=i||c>=i&&s>=c)return!1}}return!0},l=function(t,e){for(var n=f(e),r=0;r<t.length;r++)void 0!==n[t[r].id]&&(t[r].slot=n[t[r].id])},f=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];e[r.id]=r.slot}return e},d=function(t){for(var e=[],n=0;n<t.length;n++)void 0===e[t[n].slot]&&(e[t[n].slot]=[]),e[t[n].slot].push(t[n]);return e};r(i).getset("elements",function(){}).getset("on_layout_run",function(){}).getset("fixed_slot_type").getset("keep_slots",!0).method({gene_slot:s});return i.fixed_slot_type.check(function(t){return"collapsed"===t||"expanded"===t}),i};e.exports=n=o},{"tnt.api":4}]},{},[1]);