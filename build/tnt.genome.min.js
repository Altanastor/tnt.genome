!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=n[i]={exports:{}};e[i][0].call(c.exports,function(t){var n=e[i][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t,e,n){"undefined"==typeof tnt&&(e.exports=tnt={}),tnt.board=t("./index.js"),tnt.utils=t("tnt.utils"),tnt.tooltip=t("tnt.tooltip")},{"./index.js":2,"tnt.tooltip":30,"tnt.utils":32}],2:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":39}],3:[function(t,e,n){function r(){}var o=e.exports={};o.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=r,o.addListener=r,o.once=r,o.off=r,o.removeListener=r,o.removeAllListeners=r,o.emit=r,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e,n){e.exports=t("./src/api.js")},{"./src/api.js":5}],5:[function(t,e,n){var r=function(t){var e=function(){var t=[];return t.add_batch=function(e){t.unshift(e)},t.update=function(e,n){for(var r=0;r<t.length;r++)for(var o in t[r])if(o===e)return t[r][o]=n,!0;return!1},t.add=function(e,n){if(t.update(e,n));else{var r={};r[e]=n,t.add_batch(r)}},t.get=function(e){for(var n=0;n<t.length;n++)for(var r in t[n])if(r===e)return t[n][r]},t},n=e(),r=function(){};r.check=function(e,n,o){if(!(e instanceof Array))return"function"==typeof e?e.check(n,o):t[e].check(n,o),r;for(var a=0;a<e.length;a++)r.check(e[a],n,o)},r.transform=function(e,n){if(!(e instanceof Array))return"function"==typeof e?e.transform(n):t[e].transform(n),r;for(var o=0;o<e.length;o++)r.transform(e[o],n)};var o=function(e,r){var o=[],a=[],i=r.on_getter||function(){return n.get(e)},s=r.on_setter||function(t){for(var r=0;r<a.length;r++)t=a[r](t);for(var i=0;i<o.length;i++)if(!o[i].check(t)){var s=o[i].msg||"Value "+t+" doesn't seem to be valid for this method";throw s}n.add(e,t)},u=function(e){return arguments.length?(s(e),t):i()};u.check=function(t,e){return arguments.length?(o.push({check:t,msg:e}),this):o},u.transform=function(t){return arguments.length?(a.push(t),this):a},t[e]=u},a=function(t,e){if("object"==typeof t){n.add_batch(t);for(var r in t)o(r,e)}else n.add(t,e.default_value),o(t,e)};return r.getset=function(t,e){return a(t,{default_value:e}),r},r.get=function(t,e){var n=function(){throw"Method defined only as a getter (you are trying to use it as a setter"};return a(t,{default_value:e,on_setter:n}),r},r.set=function(t,e){var n=function(){throw"Method defined only as a setter (you are trying to use it as a getter"};return a(t,{default_value:e,on_getter:n}),r},r.method=function(e,n){if("object"==typeof e)for(var o in e)t[o]=e[o];else t[e]=n;return r},r};e.exports=n=r},{}],6:[function(t,e,n){e.exports=t("./src/index")},{"./src/index":10}],7:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").defer_cancel,a=function(){"use strict";function t(t){t.parentNode.appendChild(t)}var e,n,a,i,s,u=[],c=50,l=0,f=920,d=20,p={species:void 0,chr:void 0,from:0,to:500},h={left:void 0,right:void 0},v=3,g=d3.rgb("#F8FBEF"),m=d3.behavior.zoom(),_={min:0,max:1e3,zoom_out:1e3,zoom_in:100},y=500,x=!0,b={ease:d3.ease("cubic-in-out"),extend_canvas:{left:0,right:0},show_frame:!0},w=function(t){n=d3.select(t).attr("id"),d3.select(t).classed("tnt",!0);var r=d3.select(t).append("div").attr("id","tnt_"+n).style("position","relative").classed("tnt_framed",b.show_frame?!0:!1).style("width",f+2*v+b.extend_canvas.right+b.extend_canvas.left+"px"),o=r.append("div").attr("class","tnt_groupDiv");e=o.append("svg").attr("class","tnt_svg").attr("width",f).attr("height",l).attr("pointer-events","all"),i=e.append("g").attr("transform","translate(0,20)").append("g").attr("class","tnt_g"),h.left=i.append("rect").attr("id","tnt_"+n+"_5pcap").attr("x",0).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),h.right=i.append("rect").attr("id","tnt_"+n+"_3pcap").attr("x",f-v).attr("y",0).attr("width",0).attr("height",l).attr("fill","red"),a=i.append("rect").attr("class","tnt_pane").attr("id","tnt_"+n+"_pane").attr("width",f).attr("height",l).style("fill",g)},k=r(w).getset(b).getset(_).getset(p);k.transform(w.extend_canvas,function(t){var e=w.extend_canvas();return t.left=t.left||e.left,t.right=t.right||e.right,t}),k.method("start",function(){_.max-_.min<_.zoom_out&&(_.zoom_out=_.max-_.min),A();for(var t=0;t<u.length;t++)u[t].g&&u[t].g.remove(),z(u[t]);T();var e=function(){p.to-p.from<_.zoom_in&&(p.from+_.zoom_in>_.max?p.to=_.max:p.to=p.from+_.zoom_in);for(var t=0;t<u.length;t++)j(u[t],p)};e()}),k.method("update",function(){for(var t=0;t<u.length;t++)j(u[t])});var j=function(t,e){if(t.data()){var n=t.data(),r=n;r.call(t,{loc:e,on_success:function(){t.display().update.call(t,e)}})}},A=function(){s=d3.scale.linear().domain([p.from,p.to]).range([0,f]),x&&i.call(m.x(s).scaleExtent([(p.to-p.from)/(_.zoom_out-1),(p.to-p.from)/_.zoom_in]).on("zoom",O))},q=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=!1,o=0;o<u.length;o++)if(u[o].id()===t[n].id()){r=!0,e[o]=!0;break}r||(z(t[n]),j(t[n],{from:p.from,to:p.to}))}for(var a=0;a<u.length;a++)e[a]||u[a].g.remove();u=t,T()};k.method("scroll",function(t){var e=Math.abs(t);t>0?E(e,1):0>t&&E(e,-1)}),k.method("zoom",function(t){E(1/t,0)}),k.method("find_track",function(t){for(var e=0;e<u.length;e++)if(u[e].id()===t)return u[e]}),k.method("remove_track",function(t){t.g.remove()}),k.method("add_track",function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)w.add_track(t[e]);return w}return u.push(t),w}),k.method("tracks",function(t){return arguments.length?(q(t),this):u}),k.method("width",function(t){if(!arguments.length)return f;if(c>t&&(t=c),void 0!==n){d3.select("#tnt_"+n).select("svg").attr("width",t),d3.select("#tnt_"+n).style("width",parseInt(t)+2*v+"px"),d3.select("#tnt_"+n+"_pane").attr("width",t),h.right.attr("x",t-v),f=t,s.range([0,f]),A();for(var e=0;e<u.length;e++)u[e].g.select("rect").attr("width",t),u[e].display().scale(s),u[e].display().reset.call(u[e]),u[e].display().init.call(u[e],t),u[e].display().update.call(u[e],p)}else f=t;return w}),k.method("allow_drag",function(t){return arguments.length?(x=t,x?void 0!==s&&i.call(m.x(s).scaleExtent([(p.to-p.from)/(_.zoom_out-1),(p.to-p.from)/_.zoom_in]).on("zoom",O)):m.x(d3.scale.linear()).on("zoom",null),w):x});var T=function(){for(var r=0,o=0;o<u.length;o++){var i=u[o];i.g.attr("transform")?i.g.transition().duration(y).attr("transform","translate("+b.extend_canvas.left+","+r+")"):i.g.attr("transform","translate("+b.extend_canvas.left+","+r+")"),r+=i.height()}return e.attr("height",r+d),d3.select("#tnt_"+n).style("height",r+10+d+"px"),d3.select("#tnt_"+n+"_5pcap").attr("height",r).each(function(e){t(this)}),d3.select("#tnt_"+n+"_3pcap").attr("height",r).each(function(e){t(this)}),a.attr("height",r+d),w},z=function(t){return t.g=e.select("g").select("g").append("g").attr("class","tnt_track").attr("height",t.height()),t.g.append("rect").attr("x",0).attr("y",0).attr("width",w.width()).attr("height",t.height()).style("fill",t.color()).style("pointer-events","none"),t.display()&&t.display().scale(s).init.call(t,f),w},E=function(t,e){var n,r=s.domain(),o=r[1]-r[0],a=o*t-o;switch(e){case 1:n=[~~r[0]-a,~~(r[1]-a)];break;case-1:n=[~~r[0]+a,~~(r[1]-a)];break;case 0:n=[r[0]-~~(a/2),r[1]+~~a/2]}var i=d3.interpolateNumber(r[0],n[0]),u=b.ease,c=0;d3.timer(function(){var t,n=i(u(c));switch(e){case-1:t=n+o;break;case 1:t=n+o;break;case 0:t=r[1]+r[0]-n}var a=[n,t];return s.domain(a),O(s),c+=.02,c>1})},R=function(){var t=s.domain();w.from(~~t[0]),w.to(~~t[1]);for(var e=0;e<u.length;e++){var n=u[e];j(n,p)}},C=o(R,300),O=function(t){void 0!==t&&x&&m.x(t);var e=s.domain();e[0]<=_.min+5&&d3.select("#tnt_"+n+"_5pcap").attr("width",v).transition().duration(200).attr("width",0),e[1]>=_.max-5&&d3.select("#tnt_"+n+"_3pcap").attr("width",v).transition().duration(200).attr("width",0),e[0]<_.min?m.translate([m.translate()[0]-s(_.min)+s.range()[0],m.translate()[1]]):e[1]>_.max&&m.translate([m.translate()[0]-s(_.max)+s.range()[1],m.translate()[1]]),C();for(var r=0;r<u.length;r++){var o=u[r];o.display().move.call(o)}};return w};e.exports=n=a},{"tnt.api":4,"tnt.utils":32}],8:[function(t,e,n){var r=t("tnt.api"),o=t("./spinner.js")();tnt_data={},tnt_data.sync=function(){var t=function(e){var n=this;n.data().elements(t.retriever().call(n,e.loc)),e.on_success()};return r(t).getset("elements",[]).getset("retriever",function(){}),t},tnt_data.async=function(){var t=function(e){var n=this;o.on.call(n),t.retriever().call(n,e.loc).then(function(t){n.data().elements(t),e.on_success(),o.off.call(n)})};r(t).getset("elements",[]).getset("retriever");return t},tnt_data.empty=function(){var t=tnt_data.sync();return t},e.exports=n=tnt_data},{"./spinner.js":12,"tnt.api":4}],9:[function(t,e,n){var r=t("tnt.api"),o=t("./layout.js"),a=function(){var t=d3.dispatch("click","dblclick","mouseover","mouseout"),e={create:function(){throw"create_elem is not defined in the base feature object"},mover:function(){throw"move_elem is not defined in the base feature object"},updater:function(){},guider:function(){},index:void 0,layout:o.identity(),color:"#000",scale:void 0},n={},a=function(){var t=this;t.g.selectAll(".tnt_elem").remove(),t.g.selectAll(".tnt_guider").remove()},i=function(t){var n=this;n.g.append("text").attr("x",5).attr("y",12).attr("font-size",11).attr("fill","grey").text(n.label()),e.guider.call(n,t)},s=function(n,r,o){n.on("click",t.click),n.on("mouseover",t.mouseover),n.on("dblclick",t.dblclick),n.on("mouseout",t.mouseout),e.create.call(r,n,o)},u=function(t,r){console.log("LOC"),console.log(t);var o=this,a=o.g,i=o.data().elements();void 0!==r&&(i=i[r]);var s=e.layout.call(o,i);if(void 0!==s){var u,c;u=void 0!==r?a.selectAll(".tnt_elem_"+r):a.selectAll(".tnt_elem"),c=e.index?u.data(s,function(t){return void 0!==t?e.index(t):void 0}):u.data(s),e.updater.call(o,c,e.scale);var l=c.enter();l.append("g").attr("class","tnt_elem").classed("tnt_elem_"+r,r).call(n.plot,o,e.scale),c.exit().remove()}},c=function(t){var n,r=this,o=r.g;n=void 0!==t?o.selectAll(".tnt_elem_"+t):o.selectAll(".tnt_elem"),e.mover.call(this,n)},l=function(t){t.parentNode.appendChild(t)},f=function(t){if(void 0!==t){var e=this,n=e.g;n.selectAll(".tnt_elem_"+t).each(function(){l(this)})}};return r(n).getset(e).method({reset:a,plot:s,update:u,move:c,init:i,move_to_front:f}),d3.rebind(n,t,"on")};a.composite=function(){var t={},e=[],n={},o=function(){for(var e=this,n=0;n<t.length;n++)t[n].reset.call(e)},a=function(e){var r=this;for(var o in t)t.hasOwnProperty(o)&&(t[o].scale(n.scale()),t[o].init.call(r,e))},i=function(){for(var n=this,r=0;r<e.length;r++)t[e[r]].update.call(n,void 0,e[r]),t[e[r]].move_to_front.call(n,e[r])},s=function(){var e=this;for(var n in t)t.hasOwnProperty(n)&&t[n].move.call(e,n)},u=function(r,o){return t[r]=o,e.push(r),n},c=function(){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n};return r(n).getset("scale").method({reset:o,update:i,move:s,init:a,add:u,displays:c}),n},a.area=function(){var t,e=a.line(),n=e.line(),r=d3.svg.area().interpolate(n.interpolate()).tension(e.tension()),o=e.create();e.create(function(a){var i=this,s=e.scale();void 0!==t&&i.g.select("path").remove(),o.call(i,a,s),r.x(n.x()).y1(n.y()).y0(i.height()),t=a.data(),a.remove(),i.g.append("path").attr("class","tnt_area").classed("tnt_elem",!0).datum(t).attr("d",r).attr("fill",d3.rgb(e.color()).brighter())});var i=e.mover();return e.mover(function(o){var a=this,s=e.scale();i.call(a,o,s),r.x(n.x()),a.g.select(".tnt_area").datum(t).attr("d",r)}),e},a.line=function(){var t=a(),e=function(t){return t.pos},n=function(t){return t.val},r=.7,o=d3.scale.linear(),i=d3.svg.line().interpolate("basis");t.line=function(){return i},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(e){return arguments.length?(n=e,t):n},t.tension=function(e){return arguments.length?(r=e,t):r};var s;return t.create(function(a){var u=this,c=t.scale();void 0!==s&&u.g.select("path").remove(),i.tension(r).x(function(t){return c(e(t))}).y(function(t){return u.height()-o(n(t))}),s=a.data(),a.remove(),o.domain([0,1]).range([0,u.height()-2]),u.g.append("path").attr("class","tnt_elem").attr("d",i(s)).style("stroke",t.color()).style("stroke-width",4).style("fill","none")}),t.mover(function(n){var r=this,o=t.scale();i.x(function(t){return o(e(t))}),r.g.select("path").attr("d",i(s))}),t},a.conservation=function(){var t=a.area(),e=t.create();return t.create(function(n){var r=this,o=t.scale();e.call(r,d3.select(n[0][0]),o)}),t},a.ensembl=function(){var t=a(),e="#7FFF00",n="#00BB00";return t.guider(function(e){var n=this,r=~~(n.height()-.8*n.height())/2;n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",r).attr("y2",r).style("stroke",t.color()).style("stroke-width",1),n.g.append("line").attr("class","tnt_guider").attr("x1",0).attr("x2",e).attr("y1",n.height()-r).attr("y2",n.height()-r).style("stroke",t.color()).style("stroke-width",1)}),t.create(function(e){var n=this,r=t.scale(),o=~~(n.height()-.8*n.height())/2;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",o).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",n.height()-~~(2*o)).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return"high"===e.type?d3.rgb(t.color()):"low"===e.type?d3.rgb(t.color2()):d3.rgb(t.color3())})}),t.updater(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.mover(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t.color2=function(n){return arguments.length?(e=n,t):e},t.color3=function(e){return arguments.length?(n=e,t):n},t},a.vline=function(){var t=a();return t.create(function(e){var n=t.scale(),r=this;e.append("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))}).attr("y1",0).attr("y2",r.height()).attr("stroke",t.color()).attr("stroke-width",1)}),t.mover(function(e){var n=t.scale();e.select("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))})}),t},a.pin=function(){var t=a(),e=d3.scale.linear().domain([0,0]).range([0,0]),n={pos:d3.functor("pos"),val:d3.functor("val"),domain:[0,0]},o=5;return r(t).getset(n),t.create(function(r){var a=this,i=t.scale();e.domain(t.domain()).range([o,a.height()-o-10]),r.append("line").attr("x1",function(t,e){return i(t[n.pos(t,e)])}).attr("y1",function(t){return a.height()}).attr("x2",function(t,e){return i(t[n.pos(t,e)])}).attr("y2",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("stroke",function(e){return d3.functor(t.color())(e)}),r.append("circle").attr("cx",function(t,e){return i(t[n.pos(t,e)])}).attr("cy",function(t,r){return a.height()-e(t[n.val(t,r)])}).attr("r",o).attr("fill",function(e){return d3.functor(t.color())(e)}),r.append("text").attr("font-size","13").attr("x",function(t,e){return i(t[n.pos(t,e)])}).attr("y",function(t,e){return 10}).style("text-anchor","middle").text(function(t){return t.label||""})}),t.updater(function(t){t.select("text").text(function(t){return t.label||""})}),t.mover(function(r){var o=this,a=t.scale();r.select("line").attr("x1",function(t,e){return a(t[n.pos(t,e)])}).attr("y1",function(t){return o.height()}).attr("x2",function(t,e){return a(t[n.pos(t,e)])}).attr("y2",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("circle").attr("cx",function(t,e){return a(t[n.pos(t,e)])}).attr("cy",function(t,r){return o.height()-e(t[n.val(t,r)])}),r.select("text").attr("x",function(t,e){return a(t[n.pos(t,e)])}).text(function(t){return t.label||""})}),t.guider(function(t){var e=this;e.g.append("line").attr("x1",0).attr("x2",t).attr("y1",e.height()).attr("y2",e.height()).style("stroke","black").style("stroke-with","1px")}),t},a.block=function(){var t=a();return r(t).getset("from",function(t){return t.start}).getset("to",function(t){return t.end}),t.create(function(e){var n=this,r=t.scale();e.append("rect").attr("x",function(e,n){return r(t.from()(e,n))}).attr("y",0).attr("width",function(e,n){return r(t.to()(e,n))-r(t.from()(e,n))}).attr("height",n.height()).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color})}),t.updater(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.mover(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t},a.axis=function(){var t,e,n="top",r={};return r.reset=function(){t=void 0;var e=this;e.g.selectAll("rect").remove(),e.g.selectAll(".tick").remove()},r.plot=function(){},r.move=function(){var e=this,n=e.g;n.call(t)},r.init=function(){t=void 0},r.update=function(){void 0===t&&(t=d3.svg.axis().scale(e).orient(n));var r=this,o=r.g;o.call(t)},r.orientation=function(t){return arguments.length?(n=t,this):n},r.scale=function(t){return arguments.length?(e=t,this):e},r},a.location=function(){var t,e,n={};return n.reset=function(){t=void 0},n.plot=function(){},n.init=function(){t=void 0},n.move=function(){var n=e.domain();t.select("text").text("Location: "+~~n[0]+"-"+~~n[1])},n.scale=function(t){return arguments.length?(e=t,this):e},n.update=function(n){var r=this,o=r.g,a=e.domain();void 0===t&&(t=o,t.append("text").text("Location: "+Math.round(a[0])+"-"+Math.round(a[1])))},n},e.exports=n=a},{"./layout.js":11,"tnt.api":4}],10:[function(t,e,n){var r=t("./board.js");r.track=t("./track"),r.track.data=t("./data.js"),r.track.layout=t("./layout.js"),r.track.feature=t("./feature.js"),r.track.layout=t("./layout.js"),e.exports=n=r},{"./board.js":7,"./data.js":8,"./feature.js":9,"./layout.js":11,"./track":13}],11:[function(t,e,n){var r=t("tnt.api"),o=function(){var t=function(e){var n=this;return t.elements().call(n,e),e};r(t).getset("elements",function(){});return t};o.identity=function(){return o().elements(function(t){return t})},e.exports=n=o},{"tnt.api":4}],12:[function(t,e,n){var r=function(){function t(t,e,n){t.append("rect").attr("x","46.5").attr("y","40").attr("width","7").attr("height","20").attr("rx","5").attr("ry","5").attr("fill",d3.rgb(n).darker(2)).attr("transform","rotate("+30*e+" 50 50) translate(0 -30)").append("animate").attr("attributeName","opacity").attr("from","1").attr("to","0").attr("dur","1s").attr("begin",1/12*e+"s").attr("repeatCount","indefinite")}var e,n={};return n.on=function(){var n=this;if(n.spinner?n.spinner++:n.spinner=1,1==n.spinner){var r=n.g,o=n.color();e=r.append("svg").attr("class","tnt_spinner").attr("width","30px").attr("height","30px").attr("xmls","http://www.w3.org/2000/svg").attr("viewBox","0 0 100 100").attr("preserveAspectRatio","xMidYMid"),e.append("rect").attr("x","0").attr("y","0").attr("width","100").attr("height","100").attr("rx","50").attr("ry","50").attr("fill",o);for(var a=0;12>a;a++)t(e,a,o)}else if(n.spinner>0){var i=e.node();i.parentNode&&i.parentNode.appendChild(i)}},n.off=function(){var t=this;if(t.spinner--,!t.spinner){var e=t.g;e.selectAll(".tnt_spinner").remove()}},n};e.exports=n=r},{}],13:[function(t,e,n){var r=t("tnt.api"),o=t("tnt.utils").iterator,a=function(){"use strict";var t,e={color:d3.rgb("#CCCCCC"),height:250,data:a.data.empty(),label:"",id:a.id()},n={};r(n).getset(e);return n.display=function(n){if(!arguments.length)return t;if(t=n,"function"==typeof t)t.layout&&t.layout().height(e.height);else for(var r in t)t.hasOwnProperty(r)&&t[r].layout&&t[r].layout().height(e.height);return this},n};a.id=o(1),e.exports=n=a},{"tnt.api":4,"tnt.utils":32}],14:[function(t,e,n){e.exports=tnt_ensembl=t("./src/rest.js")},{"./src/rest.js":29}],15:[function(t,e,n){(function(n,r){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function s(t){Y=t}function u(t){K=t}function c(){var t=n.nextTick,e=n.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(h)}}function l(){return function(){B(h)}}function f(){var t=0,e=new Q(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function d(){var t=new MessageChannel;return t.port1.onmessage=h,function(){t.port2.postMessage(0)}}function p(){return function(){setTimeout(h,1)}}function h(){for(var t=0;G>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}G=0}function v(){try{var e=t,n=e("vertx");return B=n.runOnLoop||n.runOnContext,l()}catch(r){return p()}}function g(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return at.error=e,at}}function x(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function b(t,e,n){K(function(t){var r=!1,o=x(n,e,function(n){r||(r=!0,e!==n?j(t,n):q(t,n))},function(e){r||(r=!0,T(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,T(t,o))},t)}function w(t,e){e._state===rt?q(t,e._result):e._state===ot?T(t,e._result):z(e,void 0,function(e){j(t,e)},function(e){T(t,e)})}function k(t,e){if(e.constructor===t.constructor)w(t,e);else{var n=y(e);n===at?T(t,at.error):void 0===n?q(t,e):a(n)?b(t,e,n):q(t,e)}}function j(t,e){t===e?T(t,m()):o(e)?k(t,e):q(t,e)}function A(t){t._onerror&&t._onerror(t._result),E(t)}function q(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&K(E,t))}function T(t,e){t._state===nt&&(t._state=ot,t._result=e,K(A,t))}function z(t,e,n,r){var o=t._subscribers,a=o.length;t._onerror=null,o[a]=e,o[a+rt]=n,o[a+ot]=r,0===a&&t._state&&K(E,t)}function E(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,a=t._result,i=0;i<e.length;i+=3)r=e[i],o=e[i+n],r?O(n,r,o,a):o(a);t._subscribers.length=0}}function R(){this.error=null}function C(t,e){try{return t(e)}catch(n){return it.error=n,it}}function O(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=C(n,r),o===it?(u=!0,i=o.error,o=null):s=!0,e===o)return void T(e,_())}else o=r,s=!0;e._state!==nt||(c&&s?j(e,o):u?T(e,i):t===rt?q(e,o):t===ot&&T(e,o))}function P(t,e){try{e(function(e){j(t,e)},function(e){T(t,e)})}catch(n){T(t,n)}}function N(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(g),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?q(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&q(n.promise,n._result))):T(n.promise,n._validationError())}function M(t){return new st(this,t).promise}function S(t){function e(t){j(o,t)}function n(t){T(o,t)}var r=this,o=new r(g);if(!J(t))return T(o,new TypeError("You must pass an array to race.")),o;for(var a=t.length,i=0;o._state===nt&&a>i;i++)z(r.resolve(t[i]),void 0,e,n);return o}function U(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(g);return j(n,t),n}function L(t){var e=this,n=new e(g);return T(n,t),n}function H(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(t){this._id=dt++,this._state=void 0,this._result=void 0,this._subscribers=[],g!==t&&(a(t)||H(),this instanceof F||I(),P(this,t))}function $(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=pt)}var X;X=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B,Y,D,J=X,G=0,K=({}.toString,function(t,e){et[G]=t,et[G+1]=e,G+=2,2===G&&(Y?Y(h):D())}),V="undefined"!=typeof window?window:void 0,W=V||{},Q=W.MutationObserver||W.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);D=Z?c():Q?f():tt?d():void 0===V&&"function"==typeof t?v():p();var nt=void 0,rt=1,ot=2,at=new R,it=new R;N.prototype._validateInput=function(t){return J(t)},N.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},N.prototype._init=function(){this._result=new Array(this.length)};var st=N;N.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===nt&&e>o;o++)t._eachEntry(r[o],o)},N.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},N.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===nt&&(r._remaining--,t===ot?T(o,n):r._result[e]=n),0===r._remaining&&q(o,r._result)},N.prototype._willSettleAt=function(t,e){var n=this;z(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(ot,e,t)})};var ut=M,ct=S,lt=U,ft=L,dt=0,pt=F;F.all=ut,F.race=ct,F.resolve=lt,F.reject=ft,F._setScheduler=s,F._setAsap=u,F._asap=K,F.prototype={constructor:F,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===ot&&!e)return this;var o=new this.constructor(g),a=n._result;if(r){var i=arguments[r-1];K(function(){O(r,o,i,a)})}else z(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ht=$,vt={Promise:pt,polyfill:ht};"function"==typeof define&&define.amd?define(function(){return vt}):"undefined"!=typeof e&&e.exports?e.exports=vt:"undefined"!=typeof this&&(this.ES6Promise=vt),ht()}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:3}],16:[function(t,e,n){"use strict";!function(t,r){"function"==typeof define&&define.amd?define(function(){return t.httppleasepromises=r(t)}):"object"==typeof n?e.exports=r(t):t.httppleasepromises=r(t)}(this,function(t){return function(e){if(e=e||t&&t.Promise,!e)throw new Error("No Promise implementation found.");return{processRequest:function(t){var n,r,o=t.onload,a=t.onerror,i=new e(function(t,e){n=t,r=e});t.onload=function(t){var e;return o&&(e=o.apply(this,arguments)),n(t),e},t.onerror=function(t){var e;return a&&(e=a.apply(this,arguments)),r(t),e},t.then=function(){return i.then.apply(i,arguments)},t["catch"]=function(){return i["catch"].apply(i,arguments)}}}}})},{}],17:[function(t,e,n){"use strict";function r(t,e){var n=new Error(t);n.name="RequestError",this.name=n.name,this.message=n.message,n.stack&&(this.stack=n.stack),this.toString=function(){return this.message};for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r])}var o=t("./response");r.prototype=Error.prototype,r.create=function(t,e,n){var a=new r(t,n);return o.call(a,e),a},e.exports=r},{"./response":20}],18:[function(t,e,n){"use strict";function r(t,e){function n(n,r){var a,p,h,v,g;for(n=new l(f(t,n)),o=0;o<e.length;o++)p=e[o],p.processRequest&&p.processRequest(n);for(o=0;o<e.length;o++)if(p=e[o],p.createXHR){a=p.createXHR(n);break}a=a||new i,n.xhr=a,h=d(s(function(t){clearTimeout(g),a.onload=a.onerror=a.onreadystatechange=a.ontimeout=a.onprogress=null;var i=t&&t.isHttpError?t:new c(n);for(o=0;o<e.length;o++)p=e[o],p.processResponse&&p.processResponse(i);t?n.onerror&&n.onerror(t):n.onload&&n.onload(i),r&&r(t,i)})),a.onreadystatechange=function(){if(!n.timedOut)if(n.aborted)h(u("Request aborted",n,{name:"Abort"}));else if(4===a.readyState){var t=Math.floor(a.status/100);if(2===t)h();else if(404!==a.status||n.errorOn404){var e;switch(t){case 4:e="Client";break;case 5:e="Server";break;default:e="HTTP"}var r=e+" Error: The server returned a status of "+a.status+' for the request "'+n.method.toUpperCase()+" "+n.url+'"';h(u(r,n))}else h()}},a.onload=function(){h()},a.onerror=function(){h(u("Internal XHR Error",n))},a.ontimeout=function(){},a.onprogress=function(){},a.open(n.method,n.url),n.timeout&&(g=setTimeout(function(){n.timedOut=!0,h(u("Request timeout",n,{name:"Timeout"}));try{a.abort()}catch(t){}},n.timeout));for(v in n.headers)n.headers.hasOwnProperty(v)&&a.setRequestHeader(v,n.headers[v]);return a.send(n.body),n}t=t||{},e=e||[];var a,p=["get","post","put","head","patch","delete"],h=function(t){return function(e,r){return e=new l(e),e.method=t,n(e,r)}};for(o=0;o<p.length;o++)a=p[o],n[a]=h(a);return n.plugins=function(){return e},n.defaults=function(n){return n?r(f(t,n),e):t},n.use=function(){var n=Array.prototype.slice.call(arguments,0);return r(t,e.concat(n))},n.bare=function(){return r()},n.Request=l,n.Response=c,n}var o,a=t("../plugins/cleanurl"),i=t("./xhr"),s=t("./utils/delay"),u=t("./error").create,c=t("./response"),l=t("./request"),f=t("xtend"),d=t("./utils/once");e.exports=r({},[a])},{"../plugins/cleanurl":25,"./error":17,"./request":19,"./response":20,"./utils/delay":21,"./utils/once":22,"./xhr":23,xtend:24}],19:[function(t,e,n){"use strict";function r(t){var e="string"==typeof t?{url:t}:t||{};this.method=e.method?e.method.toUpperCase():"GET",this.url=e.url,this.headers=e.headers||{},this.body=e.body,this.timeout=e.timeout||0,this.errorOn404=null!=e.errorOn404?e.errorOn404:!0,this.onload=e.onload,this.onerror=e.onerror}r.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this)},r.prototype.header=function(t,e){var n;for(n in this.headers)if(this.headers.hasOwnProperty(n)&&t.toLowerCase()===n.toLowerCase()){if(1===arguments.length)return this.headers[n];delete this.headers[n];break}return null!=e?(this.headers[t]=e,e):void 0},e.exports=r},{}],20:[function(t,e,n){"use strict";function r(t){var e,n,r,o=t.xhr;if(this.request=t,this.xhr=o,this.headers={},!t.aborted&&!t.timedOut){if(this.status=o.status||0,this.text=o.responseText,this.body=o.response||o.responseText,this.contentType=o.contentType||o.getResponseHeader&&o.getResponseHeader("Content-Type"),o.getAllResponseHeaders)for(n=o.getAllResponseHeaders().split("\n"),e=0;e<n.length;e++)(r=n[e].match(/\s*([^\s]+):\s+([^\s]+)/))&&(this.headers[r[1]]=r[2]);this.isHttpError=this.status>=400}}var o=t("./request");r.prototype.header=o.prototype.header,e.exports=r},{"./request":19}],21:[function(t,e,n){"use strict";e.exports=function(t){return function(){var e=Array.prototype.slice.call(arguments,0),n=function(){return t.apply(null,e)};setTimeout(n,0)}}},{}],22:[function(t,e,n){"use strict";e.exports=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments)),e}}},{}],23:[function(t,e,n){e.exports=window.XMLHttpRequest},{}],24:[function(t,e,n){function r(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}e.exports=r},{}],25:[function(t,e,n){"use strict";e.exports={processRequest:function(t){t.url=t.url.replace(/[^%]+/g,function(t){return encodeURI(t)})}}},{}],26:[function(t,e,n){"use strict";var r=t("./jsonrequest"),o=t("./jsonresponse");e.exports={processRequest:function(t){r.processRequest.call(this,t),o.processRequest.call(this,t)},processResponse:function(t){o.processResponse.call(this,t);
}}},{"./jsonrequest":27,"./jsonresponse":28}],27:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Content-Type"),n=e&&-1!==e.indexOf("application/json");(null==e||n)&&t.body&&(e||t.header("Content-Type","application/json"),t.body=JSON.stringify(t.body))}}},{}],28:[function(t,e,n){"use strict";e.exports={processRequest:function(t){var e=t.header("Accept");null==e&&t.header("Accept","application/json")},processResponse:function(t){if(t.contentType&&/^.*\/(?:.*\+)?json(;|$)/i.test(t.contentType)){var e="string"==typeof t.body?t.body:t.text;e&&(t.body=JSON.parse(e))}}}},{}],29:[function(t,e,n){var r=t("httpplease"),o=t("tnt.api"),a=t("httpplease-promises"),i=t("es6-promise").Promise,s=t("httpplease/plugins/json");r=r.use(s).use(a(i)),tnt_eRest=function(){var t={proxyUrl:"https://rest.ensembl.org"},e=0,n=function(){};n.limits={region:5e6};var a=o(n);a.getset(t),a.method("call",function(t,e){return e?r.post({url:t,body:e}):r.get({url:t})}),a.method("region2genes",function(t){for(var e={},n=[],r={},o=0;o<t.length;o++){var a=t[o];"transcript"==a.feature_type&&(a.display_name=a.external_name,r[a.id]=a,void 0===e[a.Parent]&&(e[a.Parent]=[]),e[a.Parent].push(a))}for(var i=0;i<t.length;i++){var a=t[i];if("exon"===a.feature_type){var s=r[a.Parent];void 0===s.Exon&&(s.Exon=[]),s.Exon.push(a)}}for(var u=0;u<t.length;u++){var a=t[u];if("cds"===a.feature_type){var s=r[a.Parent];void 0===s.Translation&&(s.Translation=a),a.start<s.Translation.start&&(s.Translation.start=a.start),a.end>s.Translation.end&&(s.Translation.end=a.end)}}for(var c=0;c<t.length;c++){var a=t[c];"gene"===a.feature_type&&(a.display_name=a.external_name,a.Transcript=e[a.id],n.push(a))}return n}),n.url={};var i=o(n.url);return i.method("region",function(e){var n="/overlap/region/",r=e.features||["gene"],o=r.map(function(t){return"feature="+t}),a=o.join("&");return t.proxyUrl+n+e.species+"/"+e.chr+":"+e.from+"-"+e.to+".json?"+a}),i.method("xref",function(e){var n="/xrefs/symbol/";return t.proxyUrl+n+e.species+"/"+e.name+".json?object_type=gene"}),i.method("homologues",function(e){var n="/homology/id/",r=e.format||"condensed",o="";e.target_species&&e.target_species.length&&(o=e.target_species.map(function(t){return"target_species="+t}).join(";"));var a="";e.target_taxons&&e.target_taxons.length&&(a=e.target_taxons.map(function(t){return"target_taxon="+t}).join(";"));var i=t.proxyUrl+n+e.id+".json?format="+r+";sequence=none;type=all";return o&&(i+=";"+o),a&&(i+=";"+a),i}),i.method("gene",function(e){var n="/lookup/id/",r=t.proxyUrl+n+e.id+".json?format=full";return e.expand&&(r+="&expand=1"),r}),i.method("chr_info",function(e){var n="/info/assembly/";return t.proxyUrl+n+e.species+"/"+e.chr+".json?format=full"}),i.method("aln_block",function(e){for(var n="/alignment/region/",r=t.proxyUrl+n+e.species+"/"+e.chr+":"+e.from+"-"+e.to+".json?method="+e.method,o=0;o<e.species_set.length;o++)r+="&species_set="+e.species_set[o];return r}),i.method("sequence",function(e){var n="/sequence/region/";return t.proxyUrl+n+e.species+"/"+e.chr+":"+e.from+".."+e.to+"?content-type=application/json"}),i.method("variation",function(e){var n="/variation/";return t.proxyUrl+n+e.species}),i.method("gene_tree",function(e){var n=void 0===e.member_id?"/genetree/id/":"/genetree/member/id/",r=e.member_id||e.id,o=e.sequence?e.sequence:"protein",a=e.aligned?1:0,i=e.species,s="";i&&i.length&&(s=i.map(function(t){return"species="+t}).join(";"));var u=t.proxyUrl+n+r+".json?sequence="+o+";aligned="+a;return s&&(u+=";"+s),u}),i.method("assembly",function(e){var n="/info/assembly/";return t.proxyUrl+n+e.species+".json"}),a.method("connections",function(){return e}),n},e.exports=n=tnt_eRest},{"es6-promise":15,httpplease:18,"httpplease-promises":16,"httpplease/plugins/json":26,"tnt.api":4}],30:[function(t,e,n){e.exports=tooltip=t("./src/tooltip.js")},{"./src/tooltip.js":31}],31:[function(t,e,n){var r=t("tnt.api"),o=function(){"use strict";function t(e,n){if(n=n.toLowerCase(),null===e.parentNode)return void console.log("No more parents");var r=e.parentNode.tagName;return void 0!==r&&r.toLowerCase()===n?e.parentNode:t(e.parentNode,n)}var e,n=d3.behavior.drag(),o={position:"right",allow_drag:!0,show_closer:!0,fill:function(){throw"fill is not defined in the base object"},width:180,id:1},a=function(r,i){n.origin(function(){return{x:parseInt(d3.select(this).style("left")),y:parseInt(d3.select(this).style("top"))}}).on("drag",function(){o.allow_drag&&d3.select(this).style("left",d3.event.x+"px").style("top",d3.event.y+"px")});var s=t(this,"div");if(void 0!==s){e=d3.select(s).append("div").attr("class","tnt_tooltip").classed("tnt_tooltip_active",!0).call(n),d3.select("#tnt_tooltip_"+o.id).remove(),null===d3.event&&i&&(d3.event=i);var u=d3.mouse(s);d3.event=null;var c=0;return"left"===o.position&&(c=o.width),e.attr("id","tnt_tooltip_"+o.id),e.style("left",u[0]+"px").style("top",u[1]+"px"),o.show_closer&&e.append("div").attr("class","tnt_tooltip_closer").on("click",function(){a.close()}),o.fill.call(e,r),a}},i=r(a).getset(o);return i.check("position",function(t){return"left"===t||"right"===t},"Only 'left' or 'right' values are allowed for position"),i.method("close",function(){e&&e.remove()}),a};o.list=function(){var t=o();return t.fill(function(e){var n=this,r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").text(e.header);var o=r.selectAll(".tnt_zmenu_row").data(e.rows).enter().append("tr").attr("class","tnt_zmenu_row");o.append("td").style("text-align","center").html(function(t,n){return e.rows[n].value}).each(function(e){void 0!==e.link&&d3.select(this).classed("link",1).on("click",function(e){e.link(e.obj),t.close.call(this)})})}),t},o.table=function(){var t=o();return t.fill(function(e){var n=this,r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").attr("colspan",2).text(e.header);var o=r.selectAll(".tnt_zmenu_row").data(e.rows).enter().append("tr").attr("class","tnt_zmenu_row");o.append("th").attr("colspan",function(t,e){return""===t.value?2:1}).attr("class",function(t){return""===t.value?"tnt_zmenu_inner_header":"tnt_zmenu_cell"}).html(function(t,n){return e.rows[n].label}),o.append("td").html(function(t,n){return"function"!=typeof e.rows[n].value?e.rows[n].value:void e.rows[n].value.call(this,t)}).each(function(t){""===t.value&&d3.select(this).remove()}).each(function(e){void 0!==e.link&&d3.select(this).classed("link",1).on("click",function(e){e.link(e.obj),t.close.call(this)})})}),t},o.plain=function(){var t=o();return t.fill(function(e){var n=this,r=n.append("table").attr("class","tnt_zmenu").attr("border","solid").style("width",t.width()+"px");e.header&&r.append("tr").attr("class","tnt_zmenu_header").append("th").text(e.header),e.body&&r.append("tr").attr("class","tnt_zmenu_row").append("td").style("text-align","center").html(e.body)}),t},e.exports=n=o},{"tnt.api":4}],32:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":33}],33:[function(t,e,n){var r=t("./utils.js");r.reduce=t("./reduce.js"),e.exports=n=r},{"./reduce.js":34,"./utils.js":35}],34:[function(t,e,n){var r=function(){var t=5,e="val",n=function(t,e){return e>t?.2*e>=e-t:.2*t>=t-e},r=function(t){return t},o=function(t){if(!t.length)return t;var e=s(t),n=r(e);return n},a=function(t,n){if(n.sort(function(t,n){return t[e]-n[e]}),n.length%2)t[e]=n[~~(n.length/2)][e];else{var r=~~(n.length/2)-1;t[e]=(n[r][e]+n[r+1][e])/2}return t},i=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},s=function(e){if(0===t)return e;for(var n=[],r=0;r<e.length;r++){var o=t>r?0:r-t,s=r>e.length-t?e.length:r+t;n[r]=a(i(e[r]),e.slice(o,s+1))}return n};return o.reducer=function(t){return arguments.length?(r=t,o):r},o.redundant=function(t){return arguments.length?(n=t,o):n},o.value=function(t){return arguments.length?(e=t,o):e},o.smooth=function(e){return arguments.length?(t=e,o):t},o},o=function(){var t=r().value("start"),e="end",n=function(n,r){return{object:{start:n.object[t.value()],end:r[e]},value:r[e]}};return t.reducer(function(r){for(var o=t.value(),a=t.redundant(),i=[],s={object:r[0],value:r[0][e]},u=1;u<r.length;u++)a(r[u][o],s.value)?s=n(s,r[u]):(i.push(s.object),s.object=r[u],s.value=r[u].end);return i.push(s.object),i}),r.join=function(e){return arguments.length?(n=e,t):n},r.value2=function(n){return arguments.length?(e=n,t):e},t},a=function(){var t=r();return t.reducer(function(e){for(var n=t.redundant(),r=t.value(),o=[],a=e[0],i=1;i<e.length-1;i++)n(e[i][r],a[r])||(o.push(a),a=e[i]);return o.push(a),o.push(e[e.length-1]),o}),t};e.exports=r,e.exports.line=a,e.exports.block=o},{}],35:[function(t,e,n){e.exports={iterator:function(t){var e=t||0,n=function(){return e++};return n},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(e+"$"),r=new RegExp("(.*)"+e+"$"),o=document.getElementsByTagName("script"),a="";if(void 0!==o)for(var i in o)if(o[i].src&&o[i].src.match(n))return o[i].src.replace(r,"$1");return a},defer_cancel:function(t,e){var n,r=function(){var r=Array.prototype.slice.call(arguments),o=this;clearTimeout(n),n=setTimeout(function(){t.apply(o,r)},e)};return r}}},{}],36:[function(t,e,n){var r=t("tnt.board"),o=t("tnt.api");r.track.data.retriever.ensembl={};var a=function(){var t=r.track.data.genome.rest,e=r.track.data().update(r.track.data.retriever.async().retriever(function(e){var n=t.url.region(e);return t.call(n).then(function(t){for(var e=t.body,n=0;n<e.length;n++){var r=e[n];-1===r.strand?r.display_label="<"+r.external_name:r.display_label=r.external_name+">"}return e})}));return e},i=function(){function t(t){for(var e=t.exons,n=[],r=0;r<e.length-1;r++){var o={start:1===e[r].transcript.strand?e[r].end:e[r].start,end:1===e[r].transcript.strand?e[r+1].start:e[r+1].end,transcript:t};n.push(o)}return n}function e(t){var e,n;void 0!==t.Translation&&(e=t.Translation.start,n=t.Translation.end);var r=t.Exon,o=[];if(r)for(var a=0;a<r.length;a++)if(void 0===t.Translation)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else if(r[a].start<e)if(r[a].end<e)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var i={start:r[a].start,end:e,transcript:t,coding:!1,offset:r[a].start-t.start},s={start:e,end:r[a].end,transcript:t,coding:!0,offset:e-t.start};1===r[a].strand?(o.push(i),o.push(s)):(o.push(s),o.push(i))}else if(r[a].end>n)if(r[a].start>n)o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!1,offset:r[a].start-t.start});else{var u={start:r[a].start,end:n,transcript:t,coding:!0,offset:r[a].start-t.start},c={start:n,end:r[a].end,transcript:t,coding:!1,offset:n-t.start};1===r[a].strand?(o.push(u),o.push(c)):(o.push(c),o.push(u))}else o.push({start:r[a].start,end:r[a].end,transcript:t,coding:!0,offset:r[a].start-t.start});return o}var n=r.track.data.genome.rest,a=r.track.data().update(r.track.data.retriever.async().retriever(function(t){t.features=["gene","transcript","exon","cds"];var e=n.url.region(t);return n.call(e).then(function(t){for(var e=t.body,r=n.region2genes(e),o=[],i=0;i<r.length;i++){var s=r[i],u=a.gene2Transcripts(s);o=o.concat(u)}return o})}));return o(a).method("gene2Transcripts",function(n){for(var r=n.Transcript,o=[],a=0;a<r.length;a++){var i=r[a];i.exons=e(i),i.introns=t(i),i.display_label=1===i.strand?i.display_name+">":"<"+i.display_name,i.key=i.id+"_"+i.exons.length,i.gene=n,o.push(i)}return o}),a},s=function(){var t=r.track.data.genome.rest,e=r.track.data().update(r.track.data.retriever.async().retriever(function(n){if(n.to-n.from<e.limit()){var r=t.url.sequence(n);return t.call(r).then(function(t){for(var e=t.body,n=e.id.split(":"),r=n[3],o=[],a=0;a<e.seq.length;a++)o.push({pos:+r+a,sequence:e.seq[a]});return o})}return new Promise(function(t,e){t([])})}));return o(e).getset("limit",150),e},u={gene:a,sequence:s,transcript:i};e.exports=n=u},{"tnt.api":4,"tnt.board":6}],37:[function(t,e,n){var r=t("tnt.api"),o=(t("./layout.js"),t("tnt.board")),a=function(){var t=o.track.feature().layout(o.track.layout.feature()).index(function(t){return t.key});return t.create(function(e,n){var r=this,o=e.append("g").attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});o.append("line").attr("x1",0).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y2",~~(t.layout().gene_slot().gene_height/2)).attr("fill","none").attr("stroke",r.background_color()).attr("stroke-width",2).transition().duration(500).attr("stroke",function(e){return t.foreground_color()(e)}),e.each(function(t){if(t.exons)for(var e=0;e<t.exons.length;e++)t.exons[e].slot=t.slot});var a=o.selectAll(".exons").data(function(t){return t.exons||[]},function(t){return t.start});a.enter().append("rect").attr("class","tnt_exons").attr("x",function(t){return n(t.start+t.offset)-n(t.start)}).attr("y",0).attr("width",function(t){return n(t.end)-n(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",r.background_color()).attr("stroke",r.background_color()).transition().duration(500).attr("stroke",function(e){return t.foreground_color()(e)}).attr("fill",function(e){return e.coding?t.foreground_color()(e):e.coding===!1?r.background_color():t.foreground_color()(e)}),o.append("text").attr("class","tnt_name").attr("x",0).attr("y",25).attr("fill",r.background_color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(e){return t.foreground_color()(e)})}),t.updater(function(e,n){var r=e.select("g").transition().duration(200).attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("rect").attr("height",t.layout().gene_slot().gene_height),r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.select("text").text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.mover(function(e,n){var r=e.select("g").attr("transform",function(e){return"translate("+n(e.start)+","+t.layout().gene_slot().slot_height*e.slot+")"});r.selectAll("line").attr("x2",function(t){return n(t.end)-n(t.start)}).attr("y1",~~(t.layout().gene_slot().gene_height/2)).attr("y2",~~(t.layout().gene_slot().gene_height/2)),r.selectAll("rect").attr("width",function(t){return n(t.end)-n(t.start)}),r.selectAll(".tnt_exons").attr("x",function(t){return n(t.start+t.offset)-n(t.start)})}),t},i=function(){var t={fontsize:10,sequence:function(t){return t.sequence}},e=o.track.feature().index(function(t){return t.pos});r(e).getset(t);return e.create(function(n,r){var o=this;n.append("text").attr("fill",o.background_color()).style("font-size",t.fontsize+"px").attr("x",function(e){return r(e.pos)-t.fontsize/2+1}).attr("y",function(t){return~~(o.height()/2)+5}).style("font-family",'"Lucida Console", Monaco, monospace').text(t.sequence).transition().duration(500).attr("fill",e.foreground_color())}),e.mover(function(e,n){e.select("text").attr("x",function(e){return n(e.pos)-t.fontsize/2+1})}),e},s=function(){var t=o.track.feature().layout(o.track.layout.feature()).index(function(t){return t.id});return t.create(function(e,n){var r=this;e.append("rect").attr("x",function(t){return n(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("width",function(t){return n(t.end)-n(t.start)}).attr("height",t.layout().gene_slot().gene_height).attr("fill",r.background_color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.foreground_color():e.color}),e.append("text").attr("class","tnt_name").attr("x",function(t){return n(t.start)}).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).attr("fill",r.background_color()).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""}).style("font-weight","normal").transition().duration(500).attr("fill",function(){return t.foreground_color()})}),t.updater(function(e){e.select("rect").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot}).attr("height",t.layout().gene_slot().gene_height),e.select("text").transition().duration(500).attr("y",function(e){return t.layout().gene_slot().slot_height*e.slot+25}).text(function(e){return t.layout().gene_slot().show_label?e.display_label:""})}),t.mover(function(t,e){t.select("rect").attr("x",function(t){return e(t.start)}).attr("width",function(t){return e(t.end)-e(t.start)}),t.select("text").attr("x",function(t){return e(t.start)})}),t},u=function(){var t,e,n,r=function(t,e,n,r){return t+" "+e+":"+n+"-"+r},o={};return o.reset=function(){},o.plot=function(){},o.init=function(){t=void 0},o.move=function(o){var a=o.domain();t.select("text").text(r(n,e,~~a[0],~~a[1]))},o.update=function(o,a){e=a.chr,n=a.species;var i=this,s=i.g,u=o.domain();void 0===t&&(t=s,t.append("text").text(r(n,e,~~u[0],~~u[1])))},o.text=function(t){return arguments.length?(r=t,this):r},o},c={gene:s,sequence:i,transcript:a,location:u};e.exports=n=c},{"./layout.js":40,"tnt.api":4,"tnt.board":6}],38:[function(t,e,n){var r=t("tnt.ensembl"),o=t("tnt.api"),a=t("tnt.board");a.track.data.genome=t("./data.js"),a.track.feature.genome=t("./feature"),a.track.layout.feature=t("./layout"),tnt_board_genome=function(){"use strict";var t=/^ENS\w+\d+$/,e={gene:void 0,xref_search:function(){},ensgene_search:function(){},context:0,rest:r()};a.track.data.genome.rest=e.rest;var n=a().zoom_in(200).zoom_out(e.rest.limits.region).left(0),i=a.track().height(20).background_color("white").data(a.track.data.empty()).display(a.track.feature.genome.location()),s=a.track().height(0).background_color("white").data(a.track.data.empty()).display(a.track.feature.axis());n.add_track(i).add_track(s),n.species("human").chr(7).from(139424940).to(141784100),n._start=n.start;var u=function(t){if(void 0!==t){if(void 0!==t.gene)return void f(t);void 0===t.species?t.species=n.species():n.species(t.species),void 0===t.chr?t.chr=n.chr():n.chr(t.chr),void 0===t.from?t.from=n.from():n.from(t.from),void 0===t.to?t.to=n.to():n.to(t.to)}else{if(void 0!==n.gene())return void f({species:n.species(),gene:n.gene()});t={},t.species=n.species(),t.chr=n.chr(),t.from=n.from(),t.to=n.to()}n.right(function(n){var r=e.rest.url.chr_info({species:t.species,chr:t.chr});e.rest.call(r).then(function(t){n(t.body.length)})}),n._start()},c=function(t,n){var r=e.rest.url.homologues({id:t});e.rest.call(r).then(function(t){var e=t.body.data[0].homologies;if(void 0!==n){var r=p(e);n(r)}})},l=function(e){return e.match(t)?!0:!1},f=function(t){if(l(t.gene))d(t.gene);else{var n=e.rest.url.xref({species:t.species,name:t.gene});e.rest.call(n).then(function(n){var r=n.body;r=r.filter(function(t){return!t.id.indexOf("ENS")}),void 0!==r[0]&&d(r[0].id),e.xref_search(n,t.gene,t.species)})}},d=function(t){var r=e.rest.url.gene({id:t});e.rest.call(r).then(function(t){var r=t.body;e.ensgene_search(r);var o=~~((r.end-r.start)*(e.context/100));n.species(r.species).chr(r.seq_region_name).from(r.start-o).to(r.end+o),n.start({species:r.species,chr:r.seq_region_name,from:r.start-o,to:r.end+o})})},p=function(t){var e=/ortholog/,n=/paralog/,r=t.filter(function(t){return t.type.match(e)}),o=t.filter(function(t){return t.type.match(n)});return{orthologues:r,paralogues:o}},h=o(n).getset(e);return h.method({start:u,homologues:c}),n},e.exports=n=tnt_board_genome},{"./data.js":36,"./feature":37,"./layout":40,"tnt.api":4,"tnt.board":6,"tnt.ensembl":14}],39:[function(t,e,n){var r=t("tnt.board");r.genome=t("./genome"),e.exports=n=r},{"./genome":38,"tnt.board":6}],40:[function(t,e,n){var r=t("tnt.api"),o=function(){var t,e,n=[],o={expanded:{slot_height:30,gene_height:10,show_label:!0},collapsed:{slot_height:10,gene_height:7,show_label:!1}},a="expanded",i=function(r,s){var c=this;e=s;for(var f=0;f<r.length;f++)null===r[f].external_name&&(r[f].external_name="");t=~~(c.height()/o.expanded.slot_height),i.keep_slots()&&l(r,n);var d=u(r);return o.collapsed.needed_slots=d,o.expanded.needed_slots=d,a=i.fixed_slot_type()?i.fixed_slot_type():d>t?"collapsed":"expanded",i.on_layout_run()(o,a),n=r,r},s=function(){return o[a]},u=function(e){for(var n=[],r=e,o=0,a=0;a<e.length;a++)e[a].slot>o&&e[a].slot<t&&(o=e[a].slot);for(var a=0;a<r.length;a++){var i=d(n),s=r[a];if(void 0!==s.slot&&s.slot<t&&c(s,i[s.slot]))n.push(s);else for(var u=0;;){if(c(s,i[u])){s.slot=u,n.push(s),u>o&&(o=u);break}u++}}return o+1},c=function(t,n){if(void 0===n)return!0;for(var r=0;r<n.length;r++){var o=n[r];if(t.id!==o.id){var a=8*o.display_label.length+e(o.start),i=e(o.start),s=e(o.end)>a?e(o.end):a,u=8*t.display_label.length+e(t.start),c=e(t.start),l=e(t.end)>u?e(t.end):u;if(i>=c&&l>=i||c>=i&&s>=c)return!1}}return!0},l=function(t,e){for(var n=f(e),r=0;r<t.length;r++)void 0!==n[t[r].id]&&(t[r].slot=n[t[r].id])},f=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];e[r.id]=r.slot}return e},d=function(t){for(var e=[],n=0;n<t.length;n++)void 0===e[t[n].slot]&&(e[t[n].slot]=[]),e[t[n].slot].push(t[n]);return e};r(i).getset("elements",function(){}).getset("on_layout_run",function(){}).getset("fixed_slot_type").getset("keep_slots",!0).method({gene_slot:s});return i.fixed_slot_type.check(function(t){return"collapsed"===t||"expanded"===t}),i};e.exports=n=o},{"tnt.api":4}]},{},[1]);